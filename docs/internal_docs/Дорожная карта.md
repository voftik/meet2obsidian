# Meet2Obsidian: Дорожная карта разработки

## Обзор дорожной карты

Данная дорожная карта представляет собой структурированный план разработки проекта Meet2Obsidian, адаптированный для разработчика с начальным уровнем Python, использующего Cursor и LLM от Anthropic (Claude) в качестве вспомогательных инструментов. План разбит на четко определенные фазы, каждая из которых содержит набор задач с оценкой трудоемкости и рекомендуемыми ресурсами.

Учитывая доступное время (10 часов в неделю), дорожная карта рассчитана на **16 недель** для разработки MVP с полной функциональностью.

## Фаза 0: Подготовка окружения и планирование (1 неделя)

### Задачи:
1. **Настройка окружения разработки** (3 часа)
   - Установка Python 3.9+ на macOS
   - Настройка виртуального окружения
   - Настройка Git для контроля версий
   - Настройка Cursor с интеграцией GitHub
   - Установка FFmpeg

2. **Создание структуры проекта** (2 часа)
   - Создание базовой структуры директорий
   - Настройка pyproject.toml/setup.py
   - Инициализация Git-репозитория
   - Создание README.md

3. **Подготовка документации плана разработки** (3 часа)
   - Детализация задач для каждой фазы
   - Создание диаграммы Ганта или канбан-доски
   - Документирование спецификации API

4. **Получение и настройка ключей API** (2 часа)
   - Регистрация в Rev.ai
   - Получение ключа Claude API
   - Подготовка тестовых видеозаписей

### Ожидаемые результаты:
- Полностью настроенное окружение разработки
- Структура проекта с базовыми файлами
- Подробный план разработки
- Готовые ключи API для тестирования

### Ресурсы и инструменты:
- Документация Python по виртуальным окружениям: https://docs.python.org/3/tutorial/venv.html
- Руководство по настройке Git: https://git-scm.com/book/en/v2/Getting-Started-First-Time-Git-Setup
- Документация API Rev.ai: https://www.rev.ai/docs
- Документация API Claude: https://docs.anthropic.com/claude/

## Фаза 1: Разработка базовой структуры и CLI (2 недели)

### Неделя 1: Основная структура проекта и тестирование

1. **Разработка структуры конфигурации** (3 часа)
   - Создание классов ConfigManager
   - Разработка тестов для ConfigManager
   - Имплементация загрузки и сохранения JSON-конфигурации

2. **Реализация базового логирования** (3 часа)
   - Настройка структурированного логирования с structlog
   - Разработка тестов для системы логирования
   - Имплементация ротации логов

3. **Управление API-ключами** (4 часа)
   - Создание классов для работы с Keychain
   - Разработка тестов для хранилища ключей
   - Имплементация сохранения и получения API-ключей

### Неделя 2: CLI и инициализация приложения

1. **Разработка CLI-интерфейса** (5 часов)
   - Использование click для создания структуры команд
   - Реализация базовых команд (start, stop, status)
   - Разработка тестов для CLI

2. **Инициализация приложения** (3 часа)
   - Создание ApplicationManager
   - Реализация механизма обработки сигналов
   - Разработка тестов для жизненного цикла приложения

3. **Интеграция с LaunchAgents** (2 часа)
   - Реализация генерации и установки plist-файла
   - Разработка тестов для автозапуска
   - Имплементация команд для управления автозапуском

### Ожидаемые результаты:
- Функционирующее приложение с CLI-интерфейсом
- Система конфигурации и управления ключами
- Настроенное логирование
- Механизм автозапуска через LaunchAgents

### Ресурсы и инструменты:
- Документация по click: https://click.palletsprojects.com/
- Руководство по structlog: https://www.structlog.org/en/stable/
- Документация по keyring: https://keyring.readthedocs.io/
- Руководство по LaunchAgents: https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html

## Фаза 2: Мониторинг файлов и обработка аудио (3 недели)

### Неделя 3: Мониторинг файловой системы

1. **Разработка компонента наблюдения за файлами** (5 часов)
   - Создание классов для работы с watchdog
   - Разработка тестов для обнаружения новых файлов
   - Имплементация отслеживания завершения копирования файлов

2. **Управление очередью обработки** (5 часов)
   - Создание системы отслеживания состояния обработки
   - Разработка тестов для системы отслеживания
   - Имплементация сохранения состояния между запусками

### Неделя 4: Обработка видео и извлечение аудио

1. **Интеграция с FFmpeg** (5 часов)
   - Создание классов для работы с ffmpeg-python
   - Разработка тестов для извлечения аудио
   - Имплементация получения метаданных видео

2. **Управление файлами** (5 часов)
   - Реализация безопасного удаления исходных файлов
   - Разработка тестов для работы с файлами
   - Имплементация обработки ошибок файловых операций

### Неделя 5: Система кэширования

1. **Разработка компонента кэширования** (6 часов)
   - Создание классов для управления кэшем
   - Разработка тестов для операций с кэшем
   - Имплементация очистки устаревших данных кэша

2. **Интеграция кэширования с системой обработки** (4 часа)
   - Реализация проверки наличия файлов в кэше
   - Разработка тестов для работы с кэшированными данными
   - Имплементация оптимизации обработки с использованием кэша

### Ожидаемые результаты:
- Функционирующая система мониторинга файлов
- Компонент извлечения аудио из видео
- Система управления кэшем
- Интеграция компонентов в единый конвейер обработки

### Ресурсы и инструменты:
- Документация по watchdog: https://python-watchdog.readthedocs.io/
- Документация по ffmpeg-python: https://github.com/kkroening/ffmpeg-python
- Руководство по работе с файловой системой: https://docs.python.org/3/library/os.path.html
- Примеры работы с кэшированием в Python: https://cachetools.readthedocs.io/

## Фаза 3: Интеграция с API и анализ контента (4 недели)

### Неделя 6: Интеграция с Rev.ai API

1. **Разработка клиента Rev.ai** (5 часов)
   - Создание классов для работы с Rev.ai SDK
   - Разработка тестов с использованием моков
   - Имплементация отправки аудиофайлов на транскрибацию

2. **Управление заданиями транскрибации** (5 часов)
   - Реализация отслеживания статуса заданий
   - Разработка тестов для асинхронной обработки
   - Имплементация обработки ошибок API

### Неделя 7: Получение и обработка транскрипций

1. **Получение результатов транскрибации** (4 часа)
   - Реализация получения и сохранения транскрипций
   - Разработка тестов для работы с результатами
   - Имплементация обработки ошибок получения результатов

2. **Предобработка текста транскрипции** (6 часов)
   - Создание классов для форматирования текста
   - Разработка тестов для обработки текста
   - Имплементация подготовки текста для анализа

### Неделя 8: Интеграция с Claude API

1. **Разработка клиента Claude API** (5 часов)
   - Создание классов для работы с Anthropic SDK
   - Разработка тестов с использованием моков
   - Имплементация базовых запросов к Claude API

2. **Подготовка шаблонов промптов** (5 часов)
   - Создание системы шаблонов для различных типов анализа
   - Разработка тестов для шаблонизатора
   - Имплементация загрузки и использования шаблонов

### Неделя 9: Анализ контента с помощью Claude

1. **Извлечение информации о встрече** (3 часа)
   - Реализация анализа для выделения общей информации
   - Разработка тестов для анализа информации
   - Имплементация обработки результатов анализа

2. **Создание резюме и выделение задач** (4 часа)
   - Реализация анализа для создания кратких резюме
   - Разработка тестов для анализа резюме
   - Имплементация выделения задач и договоренностей

3. **Оптимизация запросов к API** (3 часа)
   - Реализация разделения длинных транскрипций
   - Разработка тестов для обработки больших текстов
   - Имплементация управления токенами и квотами API

### Ожидаемые результаты:
- Полная интеграция с Rev.ai для транскрибации
- Система работы с Claude API для анализа
- Оптимизированная обработка длинных текстов
- Извлечение структурированной информации из транскрипций

### Ресурсы и инструменты:
- Документация по Rev.ai SDK: https://github.com/revdotcom/revai-python-sdk
- Документация по Anthropic SDK: https://github.com/anthropics/anthropic-sdk-python
- Примеры форматирования текста в Python: https://docs.python.org/3/library/textwrap.html
- Руководство по шаблонизации: https://jinja.palletsprojects.com/

## Фаза 4: Генерация заметок и интеграция с Obsidian (3 недели)

### Неделя 10: Генерация Markdown-заметок

1. **Разработка генератора заметок** (5 часов)
   - Создание классов для формирования Markdown-документов
   - Разработка тестов для генерации заметок
   - Имплементация создания структурированных заметок

2. **Создание шаблонов заметок** (5 часов)
   - Разработка системы шаблонов для заметок
   - Разработка тестов для шаблонизатора
   - Имплементация подстановки данных в шаблоны

### Неделя 11: Интеграция с Obsidian

1. **Работа с файловой системой Obsidian** (5 часов)
   - Создание классов для взаимодействия с vault
   - Разработка тестов для работы с директориями
   - Имплементация создания и обновления заметок

2. **Форматирование для совместимости с Obsidian** (5 часов)
   - Реализация создания frontmatter в YAML
   - Разработка тестов для Obsidian-совместимости
   - Имплементация специфических синтаксических конструкций

### Неделя 12: Обработка медиафайлов и очистка

1. **Окончательная обработка файлов** (4 часа)
   - Реализация очистки временных и исходных файлов
   - Разработка тестов для очистки файлов
   - Имплементация управления хранением файлов

2. **Оптимизация и завершение полного конвейера** (6 часов)
   - Интеграция всех компонентов в единый процесс
   - Разработка интеграционных тестов
   - Имплементация обработки ошибок на каждом этапе

### Ожидаемые результаты:
- Генератор Markdown-заметок
- Интеграция с Obsidian vault
- Полный конвейер обработки файлов
- Оптимизированная очистка временных файлов

### Ресурсы и инструменты:
- Руководство по синтаксису Markdown: https://www.markdownguide.org/
- Документация по Obsidian: https://help.obsidian.md/
- Примеры работы с YAML в Python: https://pyyaml.org/wiki/PyYAMLDocumentation
- Руководство по управлению файлами: https://docs.python.org/3/library/shutil.html

## Фаза 5: Интеграция, тестирование и документация (3 недели)

### Неделя 13: Системная интеграция

1. **Интеграция всех компонентов** (5 часов)
   - Создание системных интеграционных тестов
   - Проверка взаимодействия всех компонентов
   - Исправление проблем взаимодействия

2. **Оптимизация производительности** (5 часов)
   - Профилирование приложения
   - Выявление узких мест
   - Оптимизация использования ресурсов

### Неделя 14: Тестирование и отладка

1. **Полное системное тестирование** (5 часов)
   - Создание тестовых сценариев
   - Тестирование с реальными файлами
   - Отладка выявленных проблем

2. **Проверка граничных случаев** (5 часов)
   - Тестирование с файлами разных размеров
   - Проверка обработки ошибок
   - Тестирование восстановления после сбоев

### Неделя 15: Документация и подготовка к релизу

1. **Разработка пользовательской документации** (4 часа)
   - Написание руководства пользователя
   - Создание инструкций по установке
   - Подготовка FAQ

2. **Техническая документация** (4 часа)
   - Документирование API и компонентов
   - Создание руководства по разработке
   - Документирование архитектуры системы

3. **Подготовка формулы Homebrew** (2 часа)
   - Создание Ruby-скрипта для Homebrew
   - Тестирование установки через Homebrew
   - Подготовка к публикации

### Неделя 16: Финальная полировка и релиз

1. **Окончательное тестирование** (4 часа)
   - Проверка всей функциональности
   - Тестирование установки и настройки
   - Финальные исправления ошибок

2. **Подготовка релиза** (3 часа)
   - Создание тегов релиза в Git
   - Подготовка файлов для распространения
   - Обновление README и документации

3. **Развертывание и публикация** (3 часа)
   - Публикация на GitHub
   - Настройка выпуска новых версий
   - Подготовка инструкций по обновлению

### Ожидаемые результаты:
- Полностью интегрированная система
- Протестированное приложение с документацией
- Готовая формула Homebrew
- Публичный релиз v1.0.0

### Ресурсы и инструменты:
- Руководство по созданию формул Homebrew: https://docs.brew.sh/Formula-Cookbook
- Руководство по документированию Python-проектов: https://realpython.com/documenting-python-code/
- Руководство по выпуску релизов на GitHub: https://docs.github.com/en/repositories/releasing-projects-on-github/managing-releases-in-a-repository

## Рекомендации по использованию Cursor и Claude для разработки

### Общие рекомендации:

1. **Структурированные запросы к Claude**:
   - Разбивайте запросы на конкретные задачи
   - Предоставляйте контекст и спецификации
   - Запрашивайте пояснения к сгенерированному коду

2. **Эффективная работа с Cursor**:
   - Используйте функции автодополнения
   - Применяйте встроенные инструменты рефакторинга
   - Изучите сочетания клавиш для повышения эффективности

### Для разработки тестов:

```python
# Примерный запрос к Claude для разработки теста
"""
Создай тесты для класса ConfigManager, который имеет следующие методы:
- load_config(config_path): загружает JSON-конфигурацию из файла
- save_config(config_path, config): сохраняет конфигурацию в файл
- get_value(key, default=None): получает значение из конфигурации по ключу
- set_value(key, value): устанавливает значение в конфигурацию

Используй pytest и мокирование операций с файлами.
"""
```

### Для разработки функциональности:

```python
# Примерный запрос к Claude для разработки класса
"""
Создай класс AudioExtractor, который извлекает аудио из видеофайла с помощью ffmpeg-python.
Класс должен иметь следующие методы:
- extract_audio(video_path, output_path): извлекает аудио из видео в формат M4A
- get_video_duration(video_path): получает длительность видео в секундах
- is_valid_video(video_path): проверяет, является ли файл корректным видеофайлом

Используй обработку ошибок и логирование.
"""
```

### Для отладки:

```python
# Примерный запрос к Claude для отладки
"""
У меня возникает ошибка в коде:

try:
    video_info = next((stream for stream in probe['streams'] 
                      if stream['codec_type'] == 'video'), None)
    if video_info:
        return float(video_info['duration']), True
    return 0, False
except ffmpeg.Error as e:
    return 0, False

Ошибка: KeyError: 'duration'

Как исправить эту проблему? Как корректно получить длительность видео через ffmpeg-python?
"""
```

## Диаграмма Ганта (упрощенная)

```
Фаза 0: Подготовка окружения и планирование    |###| Неделя 1
Фаза 1: Разработка базовой структуры и CLI     |######| Недели 2-3
Фаза 2: Мониторинг файлов и обработка аудио    |#########| Недели 4-6
Фаза 3: Интеграция с API и анализ контента     |############| Недели 7-10
Фаза 4: Генерация заметок и Obsidian           |#########| Недели 11-13
Фаза 5: Интеграция, тестирование, документация |#########| Недели 14-16
```

## Контрольные точки и измерение прогресса

1. **Контрольная точка 1 (Конец недели 3)**:
   - Функционирующее приложение с CLI
   - Система конфигурации и логирования
   - Настроенные тесты

2. **Контрольная точка 2 (Конец недели 6)**:
   - Работающий мониторинг файлов
   - Извлечение аудио из видео
   - Система кэширования

3. **Контрольная точка 3 (Конец недели 10)**:
   - Полная интеграция с Rev.ai
   - Анализ контента через Claude API
   - Структурированные результаты анализа

4. **Контрольная точка 4 (Конец недели 13)**:
   - Генерация заметок Markdown
   - Интеграция с Obsidian
   - Полный конвейер обработки

5. **Контрольная точка 5 (Конец недели 16)**:
   - Полностью протестированное приложение
   - Документация
   - Готовый релиз
