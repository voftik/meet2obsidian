## 1. ะะฑัะธะน ะพะฑะทะพั ะฐััะธัะตะบัััั

Meet2Obsidian ัะตะฐะปะธะทัะตััั ะบะฐะบ ะผะพะฝะพะปะธัะฝะพะต Python-ะฟัะธะปะพะถะตะฝะธะต ะดะปั macOS, ัะฐะฑะพัะฐััะตะต ะฒ ัะพะฝะพะฒะพะผ ัะตะถะธะผะต ะธ ัะฟัะฐะฒะปัะตะผะพะต ัะตัะตะท ะบะพะผะฐะฝะดะฝัั ัััะพะบั. ะัะฝะพะฒะฝะฐั ะฐััะธัะตะบัััะฐ ัะปะตะดัะตั ะฟัะธะฝัะธะฟะฐะผ ะผะพะดัะปัะฝะพััะธ ะธ ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะพะน ะพะฑัะฐะฑะพัะบะธ, ั ัะตะฝััะฐะปะธะทะพะฒะฐะฝะฝัะผ ัะฟัะฐะฒะปะตะฝะธะตะผ ะฟัะพัะตััะฐะผะธ.

### 1.1 ะััะธัะตะบัััะฝะฐั ะดะธะฐะณัะฐะผะผะฐ ะฒััะพะบะพะณะพ ััะพะฒะฝั

```mermaid
flowchart TD
    subgraph meet2obsidian["Meet2Obsidian Application"]
        style meet2obsidian fill:#f5f5f5,stroke:#333,stroke-width:2px
        
        subgraph core["Core Components"]
            style core fill:#f5f5f5,stroke:#ddd,stroke-width:1px
            
            cli[CLI Interface]
            style cli fill:#000,color:#fff,stroke:#333
            
            app[Application Core]
            style app fill:#000,color:#fff,stroke:#333
            
            config[Configuration Manager]
            style config fill:#000,color:#fff,stroke:#333
            
            logging[Logging System]
            style logging fill:#000,color:#fff,stroke:#333
            
            cache[Cache Manager]
            style cache fill:#000,color:#fff,stroke:#333
        end
        
        subgraph processing["Processing Components"]
            style processing fill:#f5f5f5,stroke:#ddd,stroke-width:1px
            
            monitor[File Monitor]
            style monitor fill:#000,color:#fff,stroke:#333
            
            pipeline[Processing Pipeline]
            style pipeline fill:#000,color:#fff,stroke:#333
            
            api[API Service Clients]
            style api fill:#000,color:#fff,stroke:#333
            
            note[Note Generator]
            style note fill:#000,color:#fff,stroke:#333
        end
        
        extensions[Extension Points]
        style extensions fill:#000,color:#fff,stroke:#333,stroke-dasharray: 5 5
        
        cli --%3E app
        app --> config
        app --> logging
        app --> cache
        
        app --> pipeline
        monitor --> pipeline
        pipeline --> api
        api --> note
        
        subgraph ext["Future Integration"]
            style ext fill:#f5f5f5,stroke:#ddd,stroke-width:1px,stroke-dasharray: 5 5
            
            flowaise[Flowaise AI]
            style flowaise fill:#000,color:#fff,stroke:#333,stroke-dasharray: 5 5
            
            langfuse[Langfuse]
            style langfuse fill:#000,color:#fff,stroke:#333,stroke-dasharray: 5 5
        end
        
        extensions -.-> ext
    end
```

### 1.2 ะะพะผะฟะพะฝะตะฝัั ัะธััะตะผั

- **CLI Interface**: ะัะตะดะพััะฐะฒะปัะตั ะฟะพะปัะทะพะฒะฐัะตะปััะบะธะน ะธะฝัะตััะตะนั ะบะพะผะฐะฝะดะฝะพะน ัััะพะบะธ
- **Application Core**: ะฆะตะฝััะฐะปัะฝัะน ะบะพะผะฟะพะฝะตะฝั ัะฟัะฐะฒะปะตะฝะธั ะฟัะธะปะพะถะตะฝะธะตะผ
- **Configuration Manager**: ะฃะฟัะฐะฒะปัะตั ะบะพะฝัะธะณััะฐัะธะตะน ะธ ะฝะฐัััะพะนะบะฐะผะธ
- **Logging System**: ะะฑะตัะฟะตัะธะฒะฐะตั ะปะพะณะธัะพะฒะฐะฝะธะต ะธ ะผะพะฝะธัะพัะธะฝะณ
- **Cache Manager**: ะฃะฟัะฐะฒะปัะตั ะปะพะบะฐะปัะฝัะผ ะบััะธัะพะฒะฐะฝะธะตะผ ะดะฐะฝะฝัั ะธ ัะตะทัะปััะฐัะพะฒ
- **File Monitor**: ะััะปะตะถะธะฒะฐะตั ะฝะพะฒัะต ัะฐะนะปั ะดะปั ะพะฑัะฐะฑะพัะบะธ
- **Processing Pipeline**: ะะพัะปะตะดะพะฒะฐัะตะปัะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ัะฐะนะปะพะฒ
- **API Service Clients**: ะะฝัะตะณัะฐัะธั ั Rev.ai ะธ Claude API
- **Note Generator**: ะกะพะทะดะฐะฝะธะต ะทะฐะผะตัะพะบ ะฒ Obsidian
- **Extension Points**: ะะฑัััะฐะบัะธะธ ะดะปั ะฑัะดััะธั ะธะฝัะตะณัะฐัะธะน

## 2. ะะตัะฐะปัะฝะพะต ะพะฟะธัะฐะฝะธะต ะบะพะผะฟะพะฝะตะฝัะพะฒ

### 2.1 CLI Interface

**ะะฐะทะฝะฐัะตะฝะธะต**: ะัะตะดะพััะฐะฒะปัะตั ะธะฝัะตััะตะนั ะบะพะผะฐะฝะดะฝะพะน ัััะพะบะธ ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะฟัะธะปะพะถะตะฝะธะตะผ.

**ะะปััะตะฒัะต ะบะปะฐััั**:
- `CommandLineParser`: ะะฐััะธะฝะณ ะฐัะณัะผะตะฝัะพะฒ ะบะพะผะฐะฝะดะฝะพะน ัััะพะบะธ
- `CommandExecutor`: ะัะฟะพะปะฝะตะฝะธะต ะบะพะผะฐะฝะด
- `StatusFormatter`: ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ะฒัะฒะพะดะฐ ััะฐัััะฐ ะธ ััะฐัะธััะธะบะธ

**ะะฝัะตััะตะนั**:
```python
class CLIInterface:
    def parse_args(self, args: List[str]) -> Dict:
        """ะะฐััะธะฝะณ ะฐัะณัะผะตะฝัะพะฒ ะบะพะผะฐะฝะดะฝะพะน ัััะพะบะธ"""
        
    def execute_command(self, command: str, options: Dict) -> int:
        """ะัะฟะพะปะฝะตะฝะธะต ะบะพะผะฐะฝะดั ะธ ะฒะพะทะฒัะฐั ะบะพะดะฐ ัะตะทัะปััะฐัะฐ"""
        
    def format_status(self, status_data: Dict) -> str:
        """ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ะดะฐะฝะฝัั ััะฐัััะฐ ะดะปั ะฒัะฒะพะดะฐ ะฒ ัะตัะผะธะฝะฐะป"""
        
    def format_logs(self, logs: List[Dict], level: str = "info") -> str:
        """ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ะปะพะณะพะฒ ะดะปั ะฒัะฒะพะดะฐ ะฒ ัะตัะผะธะฝะฐะป"""
```

**ะะพะดะดะตัะถะธะฒะฐะตะผัะต ะบะพะผะฐะฝะดั**:
- `start`: ะะฐะฟััะบ ัะตัะฒะธัะฐ 
- `stop`: ะััะฐะฝะพะฒะบะฐ ัะตัะฒะธัะฐ
- `status`: ะะพะปััะตะฝะธะต ััะฐัััะฐ ัะฐะฑะพัั
- `logs`: ะัะพัะผะพัั ะปะพะณะพะฒ
- `config`: ะฃะฟัะฐะฒะปะตะฝะธะต ะบะพะฝัะธะณััะฐัะธะตะน
- `test`: ะัะพะฒะตัะบะฐ ะทะฐะฒะธัะธะผะพััะตะน ะธ ัะพะตะดะธะฝะตะฝะธะน
- `help`: ะัะฒะพะด ัะฟัะฐะฒะบะธ

### 2.2 Application Core

**ะะฐะทะฝะฐัะตะฝะธะต**: ะฆะตะฝััะฐะปัะฝัะน ะบะพะผะฟะพะฝะตะฝั, ัะฟัะฐะฒะปัััะธะน ะถะธะทะฝะตะฝะฝัะผ ัะธะบะปะพะผ ะฟัะธะปะพะถะตะฝะธั ะธ ะบะพะพัะดะธะฝะธััััะธะน ัะฐะฑะพัั ะดััะณะธั ะบะพะผะฟะพะฝะตะฝัะพะฒ.

**ะะปััะตะฒัะต ะบะปะฐััั**:
- `ApplicationManager`: ะฃะฟัะฐะฒะปะตะฝะธะต ะถะธะทะฝะตะฝะฝัะผ ัะธะบะปะพะผ ะฟัะธะปะพะถะตะฝะธั
- `ServiceRegistry`: ะะตะตััั ัะตัะฒะธัะพะฒ ะธ ะบะพะผะฟะพะฝะตะฝัะพะฒ
- `HealthMonitor`: ะะพะฝะธัะพัะธะฝะณ ัะพััะพัะฝะธั ัะธััะตะผั
- `PipelineCoordinator`: ะะพะพัะดะธะฝะฐัะธั ะฒัะฟะพะปะฝะตะฝะธั ะบะพะฝะฒะตะนะตัะฐ ะพะฑัะฐะฑะพัะบะธ

**ะะฝัะตััะตะนั**:
```python
class ApplicationManager:
    def start(self) -> bool:
        """ะะฐะฟััะบ ะฟัะธะปะพะถะตะฝะธั"""
        
    def stop(self) -> bool:
        """ะััะฐะฝะพะฒะบะฐ ะฟัะธะปะพะถะตะฝะธั"""
        
    def get_status(self) -> Dict:
        """ะะพะปััะตะฝะธะต ัะตะบััะตะณะพ ััะฐัััะฐ"""
        
    def register_termination_handler(self) -> None:
        """ะะตะณะธัััะฐัะธั ะพะฑัะฐะฑะพััะธะบะฐ ัะธะณะฝะฐะปะพะฒ ะทะฐะฒะตััะตะฝะธั"""
        
    def install_launch_agent(self) -> bool:
        """ะฃััะฐะฝะพะฒะบะฐ LaunchAgent ะดะปั ะฐะฒัะพะทะฐะฟััะบะฐ"""
        
    def remove_launch_agent(self) -> bool:
        """ะฃะดะฐะปะตะฝะธะต LaunchAgent ะฐะฒัะพะทะฐะฟััะบะฐ"""
```

**ะะธะฐะณัะฐะผะผะฐ ัะพััะพัะฝะธะน**:
```
โโโโโโโโโโโ      start      โโโโโโโโโโโโ
โ         โโโโโโโโโโโโโโโโโถ โ          โ
โ   Idle  โ                 โ  Running โ
โ         โ โโโโโโโโโโโโโโโโโ          โ
โโโโโโโโโโโ       stop      โโโโโโโโโโโโ
     โ                            โ
     โ           error            โ
     โผ                            โผ
โโโโโโโโโโโ                 โโโโโโโโโโโโ
โ         โ                 โ          โ
โ Stopped โ                 โ  Error   โ
โ         โ                 โ          โ
โโโโโโโโโโโ                 โโโโโโโโโโโโ
```

### 2.3 Configuration Manager

**ะะฐะทะฝะฐัะตะฝะธะต**: ะฃะฟัะฐะฒะปะตะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปััะบะธะผะธ ะฝะฐัััะพะนะบะฐะผะธ, ะบะพะฝัะธะณััะฐัะธะตะน ะธ ัะตะบัะตัะฐะผะธ.

**ะะปััะตะฒัะต ะบะปะฐััั**:
- `ConfigManager`: ะฃะฟัะฐะฒะปะตะฝะธะต ะบะพะฝัะธะณััะฐัะธะพะฝะฝัะผ ัะฐะนะปะพะผ
- `KeychainManager`: ะะตะทะพะฟะฐัะฝะพะต ััะฐะฝะตะฝะธะต ัะตะบัะตัะพะฒ ะฒ macOS Keychain
- `PathResolver`: ะฃะฟัะฐะฒะปะตะฝะธะต ะฟัััะผะธ ะบ ัะฐะนะปะฐะผ ะธ ะดะธัะตะบัะพัะธัะผ
- `EnvManager`: ะฃะฟัะฐะฒะปะตะฝะธะต ะฟะตัะตะผะตะฝะฝัะผะธ ะพะบััะถะตะฝะธั

**ะะฝัะตััะตะนั**:
```python
class ConfigManager:
    def load_config(self) -> Dict:
        """ะะฐะณััะทะบะฐ ะบะพะฝัะธะณััะฐัะธะธ ะธะท ัะฐะนะปะฐ"""
        
    def save_config(self, config: Dict) -> bool:
        """ะกะพััะฐะฝะตะฝะธะต ะบะพะฝัะธะณััะฐัะธะธ ะฒ ัะฐะนะป"""
        
    def get_value(self, key: str, default: Any = None) -> Any:
        """ะะพะปััะตะฝะธะต ะทะฝะฐัะตะฝะธั ะฟะพ ะบะปััั"""
        
    def set_value(self, key: str, value: Any) -> bool:
        """ะฃััะฐะฝะพะฒะบะฐ ะทะฝะฐัะตะฝะธั ะฟะพ ะบะปััั"""
        
    def validate_config(self) -> List[str]:
        """ะะฐะปะธะดะฐัะธั ะบะพะฝัะธะณััะฐัะธะธ ะธ ะฒะพะทะฒัะฐั ัะฟะธัะบะฐ ะพัะธะฑะพะบ"""

class KeychainManager:
    def store_api_key(self, service: str, key: str) -> bool:
        """ะกะพััะฐะฝะตะฝะธะต API ะบะปััะฐ ะฒ Keychain"""
        
    def get_api_key(self, service: str) -> Optional[str]:
        """ะะพะปััะตะฝะธะต API ะบะปััะฐ ะธะท Keychain"""
        
    def delete_api_key(self, service: str) -> bool:
        """ะฃะดะฐะปะตะฝะธะต API ะบะปััะฐ ะธะท Keychain"""
```

**ะกัััะบัััะฐ ะบะพะฝัะธะณััะฐัะธะพะฝะฝะพะณะพ ัะฐะนะปะฐ**:
```yaml
# ะัะธะผะตั ะฟะพะปะฝะพะน ะบะพะฝัะธะณััะฐัะธะธ
paths:
  video_directory: "/Users/username/Documents/meet_records"
  obsidian_vault: "/Users/username/Documents/Obsidian/MainVault"
  
api:
  rev_ai:
    job_timeout: 3600
    max_retries: 3
  claude:
    model: "claude-3-opus-20240229"
    temperature: 0.1
    
processing:
  delete_video_files: true
  delete_audio_files: true
  max_video_duration: 14400  # 4 ัะฐัะฐ ะฒ ัะตะบัะฝะดะฐั
  
templates:
  prompts:
    meeting_info: "prompts/meeting_info.txt"
    summary: "prompts/summary.txt"
    agreements: "prompts/agreements.txt"
    tasks: "prompts/tasks.txt"
  
system:
  autostart: true
  loglevel: "info"
  notifications: true
```

### 2.4 Logging System

**ะะฐะทะฝะฐัะตะฝะธะต**: ะะฑะตัะฟะตัะตะฝะธะต ะฒัะตััะพัะพะฝะฝะตะน ัะธััะตะผั ะปะพะณะธัะพะฒะฐะฝะธั ะธ ะผะพะฝะธัะพัะธะฝะณะฐ.

**ะะปััะตะฒัะต ะบะปะฐััั**:
- `LogManager`: ะะพะฝัะธะณััะฐัะธั ะธ ัะฟัะฐะฒะปะตะฝะธะต ะปะพะณะธัะพะฒะฐะฝะธะตะผ
- `StatusTracker`: ะััะปะตะถะธะฒะฐะฝะธะต ััะฐัััะฐ ะพะฑัะฐะฑะพัะบะธ ัะฐะนะปะพะฒ
- `NotificationManager`: ะัะฟัะฐะฒะบะฐ ัะธััะตะผะฝัั ัะฒะตะดะพะผะปะตะฝะธะน
- `MetricsCollector`: ะกะฑะพั ะผะตััะธะบ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ

**ะะฝัะตััะตะนั**:
```python
class LogManager:
    def setup_logging(self, level: str = "info") -> None:
        """ะะฐัััะพะนะบะฐ ัะธััะตะผั ะปะพะณะธัะพะฒะฐะฝะธั"""
        
    def get_logger(self, name: str) -> logging.Logger:
        """ะะพะปััะตะฝะธะต ะปะพะณะณะตัะฐ ะดะปั ะบะพะผะฟะพะฝะตะฝัะฐ"""
        
    def get_last_logs(self, level: str = "info", count: int = 50) -> List[Dict]:
        """ะะพะปััะตะฝะธะต ะฟะพัะปะตะดะฝะธั ะทะฐะฟะธัะตะน ะปะพะณะพะฒ"""

class StatusTracker:
    def create_file_status(self, file_id: str, filename: str) -> Dict:
        """ะกะพะทะดะฐะฝะธะต ะทะฐะฟะธัะธ ััะฐัััะฐ ะดะปั ัะฐะนะปะฐ"""
        
    def update_stage_status(self, file_id: str, stage: str, status: str, **details) -> None:
        """ะะฑะฝะพะฒะปะตะฝะธะต ััะฐัััะฐ ััะฐะฟะฐ ะพะฑัะฐะฑะพัะบะธ"""
        
    def get_file_status(self, file_id: str) -> Dict:
        """ะะพะปััะตะฝะธะต ัะตะบััะตะณะพ ััะฐัััะฐ ะพะฑัะฐะฑะพัะบะธ ัะฐะนะปะฐ"""
        
    def get_all_active_statuses(self) -> List[Dict]:
        """ะะพะปััะตะฝะธะต ััะฐัััะพะฒ ะฒัะตั ะฐะบัะธะฒะฝัั ัะฐะนะปะพะฒ"""
```

**ะกัััะบัััะฐ ะทะฐะฟะธัะธ ะปะพะณะฐ**:
```json
{
  "timestamp": "2025-05-09T14:23:45.342Z",
  "level": "INFO",
  "component": "file_monitor",
  "message": "ะะพะฒัะน ัะฐะนะป ะพะฑะฝะฐััะถะตะฝ ะดะปั ะพะฑัะฐะฑะพัะบะธ",
  "details": {
    "filename": "meeting_2025-05-09.mp4",
    "size": 245788672,
    "path": "/Users/username/Documents/meet_records/meeting_2025-05-09.mp4"
  },
  "process_id": 12345
}
```

**ะกัััะบัััะฐ ะพััะปะตะถะธะฒะฐะฝะธั ััะฐัััะฐ ัะฐะนะปะฐ**:
```json
{
  "file_id": "20250509_142345_meeting",
  "original_filename": "meeting_2025-05-09.mp4",
  "start_time": "2025-05-09T14:23:45.342Z",
  "stages": [
    {"name": "detection", "status": "completed", "timestamp": "2025-05-09T14:23:45.342Z"},
    {"name": "audio_extraction", "status": "in_progress", "timestamp": "2025-05-09T14:25:12.125Z"},
    {"name": "video_cleanup", "status": "pending"},
    {"name": "transcription", "status": "pending"},
    {"name": "analysis", "status": "pending"},
    {"name": "note_creation", "status": "pending"},
    {"name": "cleanup", "status": "pending"}
  ],
  "errors": [],
  "metadata": {
    "file_size": 245788672,
    "estimated_duration": 1800
  }
}
```

### 2.5 File Monitor

**ะะฐะทะฝะฐัะตะฝะธะต**: ะะพะฝะธัะพัะธะฝะณ ะดะธัะตะบัะพัะธะธ ะฝะฐ ะฟะพัะฒะปะตะฝะธะต ะฝะพะฒัั ะฒะธะดะตะพัะฐะนะปะพะฒ ะธ ะทะฐะฟััะบ ะฟัะพัะตััะฐ ะพะฑัะฐะฑะพัะบะธ.

**ะะปััะตะฒัะต ะบะปะฐััั**:
- `FileWatcher`: ะััะปะตะถะธะฒะฐะฝะธะต ะธะทะผะตะฝะตะฝะธะน ะฒ ะดะธัะตะบัะพัะธะธ
- `FileValidator`: ะัะพะฒะตัะบะฐ ัะฐะนะปะพะฒ ะฝะฐ ัะพะพัะฒะตัััะฒะธะต ััะตะฑะพะฒะฐะฝะธัะผ
- `FileQueue`: ะัะตัะตะดั ัะฐะนะปะพะฒ ะดะปั ะพะฑัะฐะฑะพัะบะธ
- `FileMetadataExtractor`: ะะทะฒะปะตัะตะฝะธะต ะผะตัะฐะดะฐะฝะฝัั ะธะท ัะฐะนะปะพะฒ

**ะะฝัะตััะตะนั**:
```python
class FileWatcher:
    def start_watching(self, directory: str) -> None:
        """ะะฐัะฐะปะพ ะผะพะฝะธัะพัะธะฝะณะฐ ะดะธัะตะบัะพัะธะธ"""
        
    def stop_watching(self) -> None:
        """ะััะฐะฝะพะฒะบะฐ ะผะพะฝะธัะพัะธะฝะณะฐ ะดะธัะตะบัะพัะธะธ"""
        
    def on_file_created(self, file_path: str) -> None:
        """ะะฑัะฐะฑะพััะธะบ ัะพะฑััะธั ัะพะทะดะฐะฝะธั ัะฐะนะปะฐ"""
        
    def get_watch_status(self) -> Dict:
        """ะะพะปััะตะฝะธะต ััะฐัััะฐ ะฝะฐะฑะปัะดะฐัะตะปั"""

class FileValidator:
    def is_valid_video(self, file_path: str) -> Tuple[bool, Optional[str]]:
        """ะัะพะฒะตัะบะฐ ัะฐะนะปะฐ ะฝะฐ ะฒะฐะปะธะดะฝะพััั"""
        
    def check_video_duration(self, file_path: str) -> Tuple[float, bool]:
        """ะัะพะฒะตัะบะฐ ะดะปะธัะตะปัะฝะพััะธ ะฒะธะดะตะพ ะธ ะดะพะฟัััะธะผะพััะธ ะดะปั ะพะฑัะฐะฑะพัะบะธ"""
```

**ะะปะณะพัะธัะผ ะผะพะฝะธัะพัะธะฝะณะฐ ัะฐะนะปะพะฒ**:
```
1. ะะฐัะฐัั ะฝะฐะฑะปัะดะตะฝะธะต ะทะฐ ะดะธัะตะบัะพัะธะตะน ั ะฟะพะผะพััั watchdog
2. ะัะธ ะพะฑะฝะฐััะถะตะฝะธะธ ะฝะพะฒะพะณะพ ัะฐะนะปะฐ:
   a. ะัะพะฒะตัะธัั, ััะพ ััะพ MP4 ัะฐะนะป
   b. ะัะพะฒะตัะธัั, ััะพ ัะฐะนะป ะฟะพะปะฝะพัััั ะทะฐะณััะถะตะฝ (ะฝะต ะธะทะผะตะฝัะตััั)
   c. ะัะพะฒะตัะธัั ะดะปะธัะตะปัะฝะพััั ะฒะธะดะตะพ (%3C 4 ัะฐัะพะฒ)
   d. ะะทะฒะปะตัั ะผะตัะฐะดะฐะฝะฝัะต ัะฐะนะปะฐ
   e. ะกะพะทะดะฐัั ะทะฐะฟะธัั ะฒ StatusTracker
   f. ะะพะฑะฐะฒะธัั ัะฐะนะป ะฒ ะพัะตัะตะดั ะพะฑัะฐะฑะพัะบะธ
   g. ะะฐะฟัััะธัั ะพะฑัะฐะฑะพัะบั (ะตัะปะธ ะฝะต ะทะฐะฟััะตะฝะฐ)
```

### 2.6 Processing Pipeline

**ะะฐะทะฝะฐัะตะฝะธะต**: ะะพัะปะตะดะพะฒะฐัะตะปัะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ัะฐะนะปะพะฒ ัะตัะตะท ัะตัะธั ััะฐะฟะพะฒ ะพะฑัะฐะฑะพัะบะธ.

**ะะปััะตะฒัะต ะบะปะฐััั**:
- `ProcessingPipeline`: ะัะฝะพะฒะฝะพะน ะบะพะฝะฒะตะนะตั ะพะฑัะฐะฑะพัะบะธ
- `AudioExtractor`: ะะทะฒะปะตัะตะฝะธะต ะฐัะดะธะพ ะธะท ะฒะธะดะตะพัะฐะนะปะพะฒ
- `FileManager`: ะฃะฟัะฐะฒะปะตะฝะธะต ัะฐะนะปะฐะผะธ (ัะดะฐะปะตะฝะธะต, ะฟะตัะตะผะตัะตะฝะธะต)
- `RetryHandler`: ะะฑัะฐะฑะพัะบะฐ ะฟะพะฒัะพัะฝัั ะฟะพะฟััะพะบ ะฟัะธ ัะฑะพัั

**ะะฝัะตััะตะนั**:
```python
class ProcessingPipeline:
    def process_file(self, file_path: str) -> bool:
        """ะะฐัะฐัั ะพะฑัะฐะฑะพัะบั ัะฐะนะปะฐ"""
        
    def get_current_job(self) -> Optional[Dict]:
        """ะะพะปััะธัั ะธะฝัะพัะผะฐัะธั ะพ ัะตะบััะตะน ะทะฐะดะฐัะต"""
        
    def abort_current_job(self) -> bool:
        """ะัะตัะฒะฐัั ัะตะบัััั ะทะฐะดะฐัั"""
        
    def get_queue_status(self) -> Dict:
        """ะะพะปััะธัั ััะฐััั ะพัะตัะตะดะธ"""

class AudioExtractor:
    def extract_audio(self, video_path: str, output_path: str) -> Tuple[bool, Optional[str]]:
        """ะะทะฒะปะตัะตะฝะธะต ะฐัะดะธะพ ะธะท ะฒะธะดะตะพัะฐะนะปะฐ"""
        
    def get_audio_metadata(self, audio_path: str) -> Dict:
        """ะะพะปััะตะฝะธะต ะผะตัะฐะดะฐะฝะฝัั ะฐัะดะธะพัะฐะนะปะฐ"""
```

**ะญัะฐะฟั ะบะพะฝะฒะตะนะตัะฐ ะพะฑัะฐะฑะพัะบะธ**:
```
โโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโ
โ               โ     โ               โ     โ               โ
โ ะะทะฒะปะตัะตะฝะธะต    โโโโโโถโ ะฃะดะฐะปะตะฝะธะต      โโโโโโถโ ะัะฟัะฐะฒะบะฐ ะฝะฐ   โ
โ ะฐัะดะธะพ (ffmpeg)โ     โ MP4 ัะฐะนะปะฐ     โ     โ ััะฐะฝัะบัะธะฑะฐัะธั โ
โ               โ     โ               โ     โ               โ
โโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโ     โโโโโโโโโฌโโโโโโโโ
                                                    โ
โโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโ     โโโโโโโโโผโโโโโโโโ
โ               โ     โ               โ     โ               โ
โ ะกะพะทะดะฐะฝะธะต      โโโโโโโ ะะฝะฐะปะธะท        โโโโโโโ ะะพะปััะตะฝะธะต     โ
โ ะทะฐะผะตัะบะธ       โ     โ ัะตัะตะท Claude  โ     โ ััะฐะฝัะบัะธะฟัะธะธ  โ
โ               โ     โ               โ     โ               โ
โโโโโโโโโฌโโโโโโโโ     โโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโ
        โ
        โผ
โโโโโโโโโโโโโโโโโ
โ               โ
โ ะัะธััะบะฐ       โ
โ ัะฐะนะปะพะฒ        โ
โ               โ
โโโโโโโโโโโโโโโโโ
```

**ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ ะธ ะฒะพัััะฐะฝะพะฒะปะตะฝะธะต**:
```python
# ะัะธะผะตั ะฟะฐััะตัะฝะฐ ะพะฑัะฐะฑะพัะบะธ ะพัะธะฑะพะบ
def process_with_retry(self, func, *args, max_retries=3, **kwargs):
    """ะัะฟะพะปะฝะตะฝะธะต ััะฝะบัะธะธ ั ะฐะฒัะพะผะฐัะธัะตัะบะธะผะธ ะฟะพะฒัะพัะฐะผะธ ะฟัะธ ัะฑะพัั"""
    attempt = 0
    last_error = None
    
    while attempt < max_retries:
        try:
            return func(*args, **kwargs)
        except TransientError as e:  # ะัะตะผะตะฝะฝะฐั ะพัะธะฑะบะฐ, ะผะพะถะฝะพ ะฟะพะฒัะพัะธัั
            attempt += 1
            last_error = e
            self.logger.warning(f"Retry {attempt}/{max_retries} due to: {str(e)}")
            time.sleep(2 ** attempt)  # ะญะบัะฟะพะฝะตะฝัะธะฐะปัะฝะฐั ะทะฐะดะตัะถะบะฐ
        except PermanentError as e:  # ะะพััะพัะฝะฝะฐั ะพัะธะฑะบะฐ, ะฟะพะฒัะพัั ะฝะต ะฟะพะผะพะณัั
            self.logger.error(f"Permanent error: {str(e)}")
            raise
    
    # ะััะตัะฟะฐะฝั ะฒัะต ะฟะพะฟััะบะธ
    self.logger.error(f"Failed after {max_retries} attempts: {str(last_error)}")
    raise last_error
```

### 2.7 API Service Clients

**ะะฐะทะฝะฐัะตะฝะธะต**: ะะฝัะตะณัะฐัะธั ั ะฒะฝะตัะฝะธะผะธ API ัะตัะฒะธัะฐะผะธ ะดะปั ััะฐะฝัะบัะธะฑะฐัะธะธ ะธ ะฐะฝะฐะปะธะทะฐ.

**ะะปััะตะฒัะต ะบะปะฐััั**:
- `RevAiClient`: ะะปะธะตะฝั ะดะปั ะฒะทะฐะธะผะพะดะตะนััะฒะธั ั Rev.ai API
- `ClaudeClient`: ะะปะธะตะฝั ะดะปั ะฒะทะฐะธะผะพะดะตะนััะฒะธั ั Anthropic Claude API
- `ApiKeyManager`: ะฃะฟัะฐะฒะปะตะฝะธะต API ะบะปััะฐะผะธ
- `ApiRateLimiter`: ะะณัะฐะฝะธัะตะฝะธะต ัะฐััะพัั ะทะฐะฟัะพัะพะฒ ะบ API

**ะะฝัะตััะตะนั**:
```python
class RevAiClient:
    def submit_transcription_job(self, audio_path: str) -> str:
        """ะัะฟัะฐะฒะบะฐ ัะฐะนะปะฐ ะฝะฐ ััะฐะฝัะบัะธะฑะฐัะธั, ะฒะพะทะฒัะฐัะฐะตั job_id"""
        
    def check_job_status(self, job_id: str) -> str:
        """ะัะพะฒะตัะบะฐ ััะฐัััะฐ ะทะฐะดะฐัะธ ััะฐะฝัะบัะธะฑะฐัะธะธ"""
        
    def get_transcript(self, job_id: str) -> str:
        """ะะพะปััะตะฝะธะต ัะตะทัะปััะฐัะฐ ััะฐะฝัะบัะธะฑะฐัะธะธ"""

class ClaudeClient:
    def analyze_text(self, text: str, prompt_template: str, **params) -> str:
        """ะะฝะฐะปะธะท ัะตะบััะฐ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ัะฐะฑะปะพะฝะฐ ะฟัะพะผะฟัะฐ"""
        
    def get_meeting_info(self, transcript: str) -> Dict:
        """ะะพะปััะตะฝะธะต ะธะฝัะพัะผะฐัะธะธ ะพ ะฒัััะตัะต"""
        
    def get_summary(self, transcript: str) -> str:
        """ะะพะปััะตะฝะธะต ะบัะฐัะบะพะณะพ ัะพะดะตัะถะฐะฝะธั"""
        
    def get_agreements(self, transcript: str) -> List[str]:
        """ะัะดะตะปะตะฝะธะต ะดะพะณะพะฒะพัะตะฝะฝะพััะตะน"""
        
    def get_tasks(self, transcript: str) -> List[Dict]:
        """ะัะดะตะปะตะฝะธะต ะทะฐะดะฐั"""
```

**ะัะธะผะตั ะธะฝัะตะณัะฐัะธะธ ั Rev.ai**:
```python
class RevAiClient:
    def __init__(self, api_key: str, cache_manager: CacheManager):
        self.client = rev_ai.client.RevAiClient(api_key)
        self.logger = logging.getLogger('revai_client')
        self.cache_manager = cache_manager
    
    def submit_transcription_job(self, audio_path: str) -> str:
        """ะัะฟัะฐะฒะบะฐ ัะฐะนะปะฐ ะฝะฐ ััะฐะฝัะบัะธะฑะฐัะธั"""
        try:
            # ะะตะฝะตัะธััะตะผ ะบัั-ะบะปัั ะฝะฐ ะพัะฝะพะฒะต ัะตัะฐ ัะพะดะตัะถะธะผะพะณะพ ัะฐะนะปะฐ
            file_hash = self._get_file_hash(audio_path)
            
            # ะัะพะฒะตััะตะผ ะฝะฐะปะธัะธะต ัะตะทัะปััะฐัะฐ ะฒ ะบััะต
            cached_job_id = self.cache_manager.get('transcription_jobs', file_hash)
            if cached_job_id:
                self.logger.info(f"Found cached job ID for {os.path.basename(audio_path)}")
                return cached_job_id
                
            job = self.client.submit_job_local_file(
                filename=audio_path,
                metadata=f"Meet2Obsidian Job {file_hash}"
            )
            
            # ะกะพััะฐะฝัะตะผ ID ะทะฐะดะฐัะธ ะฒ ะบัั
            self.cache_manager.store('transcription_jobs', file_hash, job.id)
            
            self.logger.info(f"Submitted job {job.id} for {os.path.basename(audio_path)}")
            return job.id
        except rev_ai.ClientError as e:
            self.logger.error(f"Failed to submit job: {str(e)}")
            raise ApiSubmissionError(f"Rev.ai API error: {str(e)}")
    
    def get_transcript(self, job_id: str) -> str:
        """ะะพะปััะตะฝะธะต ัะตะทัะปััะฐัะฐ ััะฐะฝัะบัะธะฑะฐัะธะธ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะบััะฐ"""
        # ะัะพะฒะตััะตะผ ะฝะฐะปะธัะธะต ััะฐะฝัะบัะธะฟัะธะธ ะฒ ะบััะต
        cached_transcript = self.cache_manager.get('transcriptions', job_id)
        if cached_transcript:
            self.logger.info(f"Using cached transcription for job {job_id}")
            return cached_transcript
            
        try:
            transcript = self.client.get_transcript_text(job_id)
            
            # ะกะพััะฐะฝัะตะผ ััะฐะฝัะบัะธะฟัะธั ะฒ ะบัั
            self.cache_manager.store('transcriptions', job_id, transcript)
            
            return transcript
        except rev_ai.ClientError as e:
            self.logger.error(f"Failed to get transcript: {str(e)}")
            raise ApiError(f"Rev.ai API error: {str(e)}")
    
    def _get_file_hash(self, file_path: str) -> str:
        """ะะพะปััะตะฝะธะต ัะตัะฐ ัะฐะนะปะฐ ะดะปั ะบััะธัะพะฒะฐะฝะธั"""
        # ะะปั ะพะฟัะธะผะธะทะฐัะธะธ ะธัะฟะพะปัะทัะตะผ ัะพะปัะบะพ ะฟะตัะฒัะต 1MB ัะฐะนะปะฐ ะธ ะธะผั ัะฐะนะปะฐ
        buffer_size = 1024 * 1024  # 1 MB
        hasher = hashlib.md5()
        
        hasher.update(os.path.basename(file_path).encode('utf-8'))
        
        with open(file_path, 'rb') as f:
            buf = f.read(buffer_size)
            hasher.update(buf)
            
        return hasher.hexdigest()
```

**ะัะธะผะตั ะธะฝัะตะณัะฐัะธะธ ั Claude API**:
```python
class ClaudeClient:
    def __init__(self, api_key: str):
        import anthropic
        self.client = anthropic.Anthropic(api_key=api_key)
        self.model = "claude-3-opus-20240229"
        self.logger = logging.getLogger('claude_client')
    
    def analyze_text(self, text: str, prompt_template: str, **params) -> str:
        """ะะฝะฐะปะธะท ัะตะบััะฐ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ัะฐะฑะปะพะฝะฐ ะฟัะพะผะฟัะฐ"""
        try:
            # ะะฐะณััะทะบะฐ ัะฐะฑะปะพะฝะฐ ะฟัะพะผะฟัะฐ
            with open(prompt_template, 'r') as f:
                prompt = f.read()
            
            # ะะพะดััะฐะฝะพะฒะบะฐ ะฟะฐัะฐะผะตััะพะฒ ะฒ ัะฐะฑะปะพะฝ
            full_prompt = prompt.format(transcript=text, **params)
            
            # ะัะทะพะฒ API
            response = self.client.messages.create(
                model=self.model,
                max_tokens=params.get('max_tokens', 1000),
                temperature=params.get('temperature', 0.1),
                messages=[
                    {"role": "user", "content": full_prompt}
                ]
            )
            return response.content[0].text
        except Exception as e:
            self.logger.error(f"Claude API error: {str(e)}")
            raise ApiAnalysisError(f"Claude API error: {str(e)}")
```

### 2.8 Note Generator

**ะะฐะทะฝะฐัะตะฝะธะต**: ะกะพะทะดะฐะฝะธะต ััััะบัััะธัะพะฒะฐะฝะฝัั ะทะฐะผะตัะพะบ ะฒ Obsidian ะฝะฐ ะพัะฝะพะฒะต ัะตะทัะปััะฐัะพะฒ ะฐะฝะฐะปะธะทะฐ.

**ะะปััะตะฒัะต ะบะปะฐััั**:
- `NoteGenerator`: ะกะพะทะดะฐะฝะธะต ะทะฐะผะตัะพะบ ะฝะฐ ะพัะฝะพะฒะต ัะฐะฑะปะพะฝะพะฒ
- `ObsidianIntegrator`: ะะฝัะตะณัะฐัะธั ั Obsidian vault
- `TemplateManager`: ะฃะฟัะฐะฒะปะตะฝะธะต ัะฐะฑะปะพะฝะฐะผะธ ะทะฐะผะตัะพะบ
- `MarkdownFormatter`: ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ัะตะบััะฐ ะฒ Markdown

**ะะฝัะตััะตะนั**:
```python
class NoteGenerator:
    def create_note(self, file_id: str, metadata: Dict, analysis_results: Dict) -> str:
        """ะกะพะทะดะฐะฝะธะต ะทะฐะผะตัะบะธ ะฝะฐ ะพัะฝะพะฒะต ัะตะทัะปััะฐัะพะฒ ะฐะฝะฐะปะธะทะฐ"""
        
    def generate_frontmatter(self, metadata: Dict) -> str:
        """ะะตะฝะตัะฐัะธั frontmatter ะดะปั ะทะฐะผะตัะบะธ"""

class ObsidianIntegrator:
    def ensure_folder_exists(self, folder_path: str) -> bool:
        """ะัะพะฒะตัะบะฐ ะธ ัะพะทะดะฐะฝะธะต ะดะธัะตะบัะพัะธะธ ะฒ vault"""
        
    def save_note(self, note_content: str, note_path: str) -> bool:
        """ะกะพััะฐะฝะตะฝะธะต ะทะฐะผะตัะบะธ ะฒ vault"""
        
    def get_vault_info(self) -> Dict:
        """ะะพะปััะตะฝะธะต ะธะฝัะพัะผะฐัะธะธ ะพ vault"""
```

**ะกัััะบัััะฐ ะณะตะฝะตัะธััะตะผะพะน ะทะฐะผะตัะบะธ**:
```markdown
---
type: meeting
date: 2025-05-09
time: 14:30
participants: []
tags: [meeting, transcription]
---

# Meeting: Project Discussion - 2025-05-09

## ๐ Meeting Information

{meeting_info}

## ๐ Executive Summary

{summary}

## ๐ค Agreements & Decisions

{agreements}

## โ Action Items

{tasks}

## ๐ Full Transcript

{transcript}
```

### 2.9 Extension Points

**ะะฐะทะฝะฐัะตะฝะธะต**: ะัะตะดะพััะฐะฒะปะตะฝะธะต ัะพัะตะบ ัะฐััะธัะตะฝะธั ะดะปั ะฑัะดััะตะน ะธะฝัะตะณัะฐัะธะธ ั ะดะพะฟะพะปะฝะธัะตะปัะฝัะผะธ ัะตัะฒะธัะฐะผะธ.

**ะะปััะตะฒัะต ะธะฝัะตััะตะนัั**:
- `TranscriptionServiceInterface`: ะะฝัะตััะตะนั ะดะปั ัะตัะฒะธัะพะฒ ััะฐะฝัะบัะธะฑะฐัะธะธ
- `ContentAnalyzerInterface`: ะะฝัะตััะตะนั ะดะปั ะฐะฝะฐะปะธะทะฐัะพัะพะฒ ะบะพะฝัะตะฝัะฐ
- `PromptManagerInterface`: ะะฝัะตััะตะนั ะดะปั ะผะตะฝะตะดะถะตัะพะฒ ะฟัะพะผะฟัะพะฒ
- `NotePersistenceInterface`: ะะฝัะตััะตะนั ะดะปั ัะพััะฐะฝะตะฝะธั ะทะฐะผะตัะพะบ

**ะัะธะผะตัั ะธะฝัะตััะตะนัะพะฒ**:
```python
class TranscriptionServiceInterface(ABC):
    @abstractmethod
    def submit_job(self, audio_path: str) -> str:
        """ะัะฟัะฐะฒะธัั ะทะฐะดะฐัั ะฝะฐ ััะฐะฝัะบัะธะฑะฐัะธั"""
        pass
        
    @abstractmethod
    def get_result(self, job_id: str) -> str:
        """ะะพะปััะธัั ัะตะทัะปััะฐั ััะฐะฝัะบัะธะฑะฐัะธะธ"""
        pass

class ContentAnalyzerInterface(ABC):
    @abstractmethod
    def analyze(self, text: str, analysis_type: str, **params) -> Any:
        """ะะฝะฐะปะธะท ัะตะบััะฐ"""
        pass
```

**ะะพัะตะฝัะธะฐะปัะฝัะต ะธะฝัะตะณัะฐัะธะธ**:
- Flowaise AI ะดะปั ะบะฐััะพะผะฝัั ะฐะณะตะฝัะพะฒ
- Langfuse ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะฟัะพะผะฟัะฐะผะธ
- ะะพะบะฐะปัะฝัะต ะผะพะดะตะปะธ ะดะปั ะฟัะธะฒะฐัะฝะพะณะพ ะฐะฝะฐะปะธะทะฐ
- ะะปััะตัะฝะฐัะธะฒะฝัะต ัะตัะฒะธัั ััะฐะฝัะบัะธะฑะฐัะธะธ

## 3. ะะทะฐะธะผะพะดะตะนััะฒะธะต ะบะพะผะฟะพะฝะตะฝัะพะฒ

### 3.1 ะะฝะธัะธะฐะปะธะทะฐัะธั ะฟัะธะปะพะถะตะฝะธั

```mermaid
sequenceDiagram
    participant User
    participant CLI
    participant AppManager
    participant ConfigManager
    participant CacheManager
    participant FileWatcher
    
    User->>CLI: meet2obsidian start
    CLI->>AppManager: start()
    AppManager->>ConfigManager: load_config()
    ConfigManager-->>AppManager: config
    AppManager->>CacheManager: init_cache()
    CacheManager-->>AppManager: success
    AppManager->>FileWatcher: start_watching(dir)
    FileWatcher-->>AppManager: success
    AppManager-->>CLI: started
    CLI-->>User: "Service started successfully"
```

### 3.2 ะะฑัะฐะฑะพัะบะฐ ัะฐะนะปะฐ

```mermaid
sequenceDiagram
    participant FileWatcher
    participant Pipeline
    participant AudioExtractor
    participant RevAiClient
    participant ClaudeClient
    participant NoteGenerator
    
    FileWatcher->>Pipeline: process_file(path)
    Pipeline->>AudioExtractor: extract_audio(path)
    AudioExtractor-->>Pipeline: audio_path
    Pipeline->>RevAiClient: submit_job(audio_path)
    RevAiClient-->>Pipeline: job_id
    
    loop Until complete
        Pipeline->>RevAiClient: check_status(job_id)
        RevAiClient-->>Pipeline: status
    end
    
    Pipeline->>RevAiClient: get_transcript(job_id)
    RevAiClient-->>Pipeline: transcript
    
    Pipeline->>ClaudeClient: analyze_meeting_info(transcript)
    ClaudeClient-->>Pipeline: meeting_info
    Pipeline->>ClaudeClient: analyze_summary(transcript)
    ClaudeClient-->>Pipeline: summary
    Pipeline->>ClaudeClient: analyze_agreements(transcript)
    ClaudeClient-->>Pipeline: agreements
    Pipeline->>ClaudeClient: analyze_tasks(transcript)
    ClaudeClient-->>Pipeline: tasks
    
    Pipeline->>NoteGenerator: create_note(results)
    NoteGenerator-->>Pipeline: note_content
    Pipeline->>NoteGenerator: save_note(note_content)
```

### 3.3 ะะตัะฐะฝะธะทะผ ะฒะพัััะฐะฝะพะฒะปะตะฝะธั

```mermaid
sequenceDiagram
    participant System
    participant AppManager
    participant StatusTracker
    participant Pipeline
    
    System->>AppManager: restart(after crash)
    AppManager->>StatusTracker: get_incomplete_jobs()
    StatusTracker-->>AppManager: incomplete_jobs
    
    loop For each incomplete job
        AppManager->>Pipeline: resume_job(job)
        Pipeline->>StatusTracker: update_status(job_id, "resumed")
    end
```

## 4. ะฃะฟัะฐะฒะปะตะฝะธะต ัะพััะพัะฝะธะตะผ

### 4.1 ะกะพััะพัะฝะธะต ะฟัะธะปะพะถะตะฝะธั

ะกะพััะพัะฝะธะต ะฟัะธะปะพะถะตะฝะธั ััะฐะฝะธััั ะฒ ะฝะตัะบะพะปัะบะธั ะบะปััะตะฒัั ะผะตััะฐั:

1. **ะะพะฝัะธะณััะฐัะธะพะฝะฝัะน ัะฐะนะป**: `~/.config/meet2obsidian/config.yaml`
2. **ะคะฐะนะปั ััะฐัััะฐ ะพะฑัะฐะฑะพัะบะธ**: `~/.local/share/meet2obsidian/status/*.json`
3. **ะะพะณ-ัะฐะนะปั**: `~/Library/Logs/meet2obsidian/*.log`
4. **ะกะตะบัะตัั**: macOS Keychain (API ะบะปััะธ)

### 4.2 ะกะพััะฐะฝะตะฝะธะต ัะพััะพัะฝะธั ะผะตะถะดั ะทะฐะฟััะบะฐะผะธ

```python
class StateManager:
    def save_state(self) -> bool:
        """ะกะพััะฐะฝะตะฝะธะต ัะตะบััะตะณะพ ัะพััะพัะฝะธั"""
        state = {
            'active_jobs': self.pipeline.get_active_jobs(),
            'pending_jobs': self.pipeline.get_pending_jobs(),
            'last_processed_file': self.last_processed_file,
            'stats': self.metrics_collector.get_current_stats()
        }
        
        with open(self.state_file_path, 'w') as f:
            json.dump(state, f)
        return True
    
    def load_state(self) -> Dict:
        """ะะฐะณััะทะบะฐ ัะพััะฐะฝะตะฝะฝะพะณะพ ัะพััะพัะฝะธั"""
        if not os.path.exists(self.state_file_path):
            return {}
            
        with open(self.state_file_path, 'r') as f:
            return json.load(f)
    
    def restore_state(self) -> bool:
        """ะะพัััะฐะฝะพะฒะปะตะฝะธะต ัะพััะพัะฝะธั ะฟะพัะปะต ะฟะตัะตะทะฐะฟััะบะฐ"""
        state = self.load_state()
        if not state:
            return False
            
        for job in state.get('active_jobs', []):
            self.pipeline.resume_job(job)
            
        for job in state.get('pending_jobs', []):
            self.pipeline.queue_job(job)
            
        return True
```

## 5. ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ ะธ ะพัะบะฐะทะพัััะพะนัะธะฒะพััั

### 5.1 ะกััะฐัะตะณะธะธ ะฒะพัััะฐะฝะพะฒะปะตะฝะธั

1. **ะะตัะตะทะฐะฟััะบ ะฟะพัะปะต ัะฑะพั ัะธััะตะผั**:
   - ะัะธะปะพะถะตะฝะธะต ัะพััะฐะฝัะตั ัะฒะพะต ัะพััะพัะฝะธะต ะฝะฐ ะดะธัะบ
   - ะัะธ ะฟะตัะตะทะฐะฟััะบะต ะฒะพัััะฐะฝะฐะฒะปะธะฒะฐะตั ะฝะตะทะฐะฒะตััะตะฝะฝัะต ะทะฐะดะฐัะธ
   - ะัะพะดะพะปะถะฐะตั ั ะฟะพัะปะตะดะฝะตะณะพ ะธะทะฒะตััะฝะพะณะพ ัะพัะพัะตะณะพ ัะพััะพัะฝะธั

2. **ะะฑัะฐะฑะพัะบะฐ ัะตัะตะฒัั ัะฑะพะตะฒ**:
   - ะัะตะผะตะฝะฝัะต ัะฑะพะธ: ะฐะฒัะพะผะฐัะธัะตัะบะธะต ะฟะพะฒัะพัั ั ัะบัะฟะพะฝะตะฝัะธะฐะปัะฝะพะน ะทะฐะดะตัะถะบะพะน
   - ะะปะธัะตะปัะฝัะต ัะฑะพะธ: ะฟะพััะฐะฝะพะฒะบะฐ ะทะฐะดะฐั ะฒ ัะตะถะธะผ ะพะถะธะดะฐะฝะธั
   - ะะพะทะพะฑะฝะพะฒะปะตะฝะธะต ะฟัะธ ะฒะพัััะฐะฝะพะฒะปะตะฝะธะธ ัะพะตะดะธะฝะตะฝะธั

3. **ะะฑัะฐะฑะพัะบะฐ ัะฑะพะตะฒ API**:
   - ะััะปะตะถะธะฒะฐะฝะธะต ะบะฒะพั ะธ ะพะณัะฐะฝะธัะตะฝะธะน API
   - ะััะธัะพะฒะฐะฝะธะต ะฟัะพะผะตะถััะพัะฝัั ัะตะทัะปััะฐัะพะฒ
   - ะะฐะทะดะตะปะตะฝะธะต ะดะปะธะฝะฝัั ะทะฐะฟัะพัะพะฒ

### 5.2 ะะปะฐััะธัะธะบะฐัะธั ะพัะธะฑะพะบ

```python
# ะะฐะทะพะฒัะต ะบะปะฐััั ะพัะธะฑะพะบ
class Meet2ObsidianError(Exception):
    """ะะฐะทะพะฒัะน ะบะปะฐัั ะดะปั ะฒัะตั ะพัะธะฑะพะบ ะฟัะธะปะพะถะตะฝะธั"""
    pass

class TransientError(Meet2ObsidianError):
    """ะัะตะผะตะฝะฝะฐั ะพัะธะฑะบะฐ, ะบะพัะพัะฐั ะผะพะถะตั ะฑััั ะธัะฟัะฐะฒะปะตะฝะฐ ะฟัะธ ะฟะพะฒัะพัะต"""
    pass

class PermanentError(Meet2ObsidianError):
    """ะะพััะพัะฝะฝะฐั ะพัะธะฑะบะฐ, ะบะพัะพัะฐั ะฝะต ะผะพะถะตั ะฑััั ะธัะฟัะฐะฒะปะตะฝะฐ ะฟะพะฒัะพัะพะผ"""
    pass

# ะะพะฝะบัะตัะฝัะต ัะธะฟั ะพัะธะฑะพะบ
class FileAccessError(PermanentError):
    """ะัะธะฑะบะฐ ะดะพัััะฟะฐ ะบ ัะฐะนะปั"""
    pass

class NetworkError(TransientError):
    """ะกะตัะตะฒะฐั ะพัะธะฑะบะฐ"""
    pass

class ApiQuotaError(TransientError):
    """ะัะธะฑะบะฐ ะฟัะตะฒััะตะฝะธั ะบะฒะพัั API"""
    pass

class ConfigurationError(PermanentError):
    """ะัะธะฑะบะฐ ะบะพะฝัะธะณััะฐัะธะธ"""
    pass
```

### 5.3 ะกััะฐัะตะณะธะธ ะพะฟัะธะผะธะทะฐัะธะธ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะบััะธัะพะฒะฐะฝะธั

ะกะธััะตะผะฐ ะธัะฟะพะปัะทัะตั ัััะฐัะตะณะธัะตัะบะพะต ะบััะธัะพะฒะฐะฝะธะต ะดะปั ะผะธะฝะธะผะธะทะฐัะธะธ API-ะฒัะทะพะฒะพะฒ ะธ ััะบะพัะตะฝะธั ะพะฑัะฐะฑะพัะบะธ:

1. **ะััะธัะพะฒะฐะฝะธะต ััะฐะฝัะบัะธะฟัะธะน**:
   - ะกะพะทะดะฐะฝะธะต ัะฝะธะบะฐะปัะฝะพะณะพ ะธะดะตะฝัะธัะธะบะฐัะพัะฐ ะฐัะดะธะพัะฐะนะปะฐ ะฝะฐ ะพัะฝะพะฒะต ัะตัะฐ ัะพะดะตัะถะธะผะพะณะพ
   - ะฅัะฐะฝะตะฝะธะต ัะตะทัะปััะฐัะพะฒ ััะฐะฝัะบัะธะฑะฐัะธะธ ะฟะพ ะธะดะตะฝัะธัะธะบะฐัะพัั ะทะฐะดะฐัะธ
   - ะะพะฒัะพัะฝะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ัััะตััะฒัััะธั ััะฐะฝัะบัะธะฟัะธะน ะดะปั ะธะดะตะฝัะธัะฝัั ัะฐะนะปะพะฒ
   - ะัะตะดะพัะฒัะฐัะตะฝะธะต ะฟะพะฒัะพัะฝัั ะฒัะทะพะฒะพะฒ Rev.ai API ะฟัะธ ะฟะตัะตะทะฐะฟััะบะต ะพะฑัะฐะฑะพัะบะธ

2. **ะััะธัะพะฒะฐะฝะธะต ัะตะทัะปััะฐัะพะฒ ะฐะฝะฐะปะธะทะฐ**:
   - ะกะพััะฐะฝะตะฝะธะต ัะตะทัะปััะฐัะพะฒ ะฐะฝะฐะปะธะทะฐ Claude API ะฟะพ ัะตัั ะฒัะพะดะฝะพะณะพ ัะตะบััะฐ ะธ ะธัะฟะพะปัะทัะตะผะพะณะพ ะฟัะพะผะฟัะฐ
   - ะะพะฒัะพัะฝะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะฐะฝะฐะปะธัะธัะตัะบะธั ัะตะทัะปััะฐัะพะฒ ะฟัะธ ะธะดะตะฝัะธัะฝัั ะทะฐะฟัะพัะฐั
   - ะกะฝะธะถะตะฝะธะต ะทะฐััะฐั ะฝะฐ API ะธ ััะบะพัะตะฝะธะต ะพะฑัะฐะฑะพัะบะธ

3. **ะััะธัะพะฒะฐะฝะธะต ะฟัะพะผะฟัะพะฒ**:
   - ะัะตะดะฒะฐัะธัะตะปัะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ัะฐะฑะปะพะฝะพะฒ ะฟัะพะผะฟัะพะฒ ะธ ัะพััะฐะฝะตะฝะธะต ัะบะพะผะฟะธะปะธัะพะฒะฐะฝะฝัั ะฒะตััะธะน
   - ะฃัะบะพัะตะฝะธะต ะฟัะพัะตััะฐ ะณะตะฝะตัะฐัะธะธ ัะธะฝะฐะปัะฝัั ะฟัะพะผะฟัะพะฒ

4. **ะะพะปะธัะธะบะธ ัะฟัะฐะฒะปะตะฝะธั ะบััะตะผ**:
   - ะะฒัะพะผะฐัะธัะตัะบะฐั ะพัะธััะบะฐ ัััะฐัะตะฒัะธั ะดะฐะฝะฝัั ะฝะฐ ะพัะฝะพะฒะต ะฒัะตะผะตะฝะธ ะฟะพัะปะตะดะฝะตะณะพ ะธัะฟะพะปัะทะพะฒะฐะฝะธั
   - ะะฝะฒะฐะปะธะดะฐัะธั ะบััะฐ ะฟัะธ ะธะทะผะตะฝะตะฝะธะธ ะบะพะฝัะธะณััะฐัะธะธ ะธะปะธ ะพะฑะฝะพะฒะปะตะฝะธะธ ะฟัะธะปะพะถะตะฝะธั
   - ะะณัะฐะฝะธัะตะฝะธะต ัะฐะทะผะตัะฐ ะบััะฐ ั ะฟัะธะพัะธัะธะทะฐัะธะตะน ะฝะตะดะฐะฒะฝะพ ะธัะฟะพะปัะทะพะฒะฐะฝะฝัั ัะปะตะผะตะฝัะพะฒ

5. **ะะพะฝะธัะพัะธะฝะณ ัััะตะบัะธะฒะฝะพััะธ ะบััะฐ**:
   - ะััะปะตะถะธะฒะฐะฝะธะต ัะพะพัะฝะพัะตะฝะธั "ะฟะพะฟะฐะดะฐะฝะธะน" ะฒ ะบัั ะบ ะพะฑัะตะผั ัะธัะปั ะทะฐะฟัะพัะพะฒ
   - ะกะฑะพั ััะฐัะธััะธะบะธ ะฟะพ ััะบะพะฝะพะผะปะตะฝะฝะพะผั ะฒัะตะผะตะฝะธ ะธ API-ะฒัะทะพะฒะฐะผ

```python
# ะัะธะผะตั ัััะตะบัะธะฒะฝะพะณะพ ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะบััะฐ ะดะปั ะพะฟัะธะผะธะทะฐัะธะธ ะฟัะธ ะพะฑัะฐะฑะพัะบะต ัะฐะนะปะฐ
def process_file(self, file_path: str) -%3E bool:
    """ะะฟัะธะผะธะทะธัะพะฒะฐะฝะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ัะฐะนะปะฐ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะบััะธัะพะฒะฐะฝะธั"""
    try:
        # ะะตะฝะตัะธััะตะผ ัะฝะธะบะฐะปัะฝัะน ะธะดะตะฝัะธัะธะบะฐัะพั ัะฐะนะปะฐ
        file_id = self._generate_file_id(file_path)
        file_hash = self._compute_file_hash(file_path)
        
        # ะัะพะฒะตััะตะผ ะบัั ะดะปั ะฟะพะปะฝะพะณะพ ัะตะทัะปััะฐัะฐ ะพะฑัะฐะฑะพัะบะธ
        cached_result = self.cache_manager.get('processed_files', file_hash)
        if cached_result:
            self.logger.info(f"Using cached complete result for {os.path.basename(file_path)}")
            
            # ะกะพะทะดะฐะตะผ ะทะฐะผะตัะบั ะธะท ะบััะธัะพะฒะฐะฝะฝัั ะดะฐะฝะฝัั
            note_path = os.path.join(
                self.config_manager.get_value('paths.obsidian_vault'),
                'Meeting Records',
                f"{os.path.splitext(os.path.basename(file_path))[0]}.md"
            )
            
            # ะะตัะตัะพะทะดะฐะตะผ ะทะฐะผะตัะบั ะธะท ะบััะฐ
            success = self.note_generator.save_note(cached_result['note_content'], note_path)
            
            # ะะฑะฝะพะฒะปัะตะผ ััะฐััั
            self.status_tracker.update_file_status(
                file_id, 
                'completed', 
                message="Processed from cache",
                cached=True
            )
            
            return success
        
        # ะัะพะดะพะปะถะฐะตะผ ะพะฑััะฝัั ะพะฑัะฐะฑะพัะบั ั ะบััะธัะพะฒะฐะฝะธะตะผ ะฝะฐ ะบะฐะถะดะพะผ ัะฐะณะต
        # ...
        
        # ะ ะบะพะฝัะต ัะพััะฐะฝัะตะผ ะฟะพะปะฝัะน ัะตะทัะปััะฐั ะฒ ะบัั
        self.cache_manager.store('processed_files', file_hash, {
            'note_content': note_content,
            'metadata': metadata,
            'analysis_results': analysis_results,
            'processed_date': datetime.datetime.now().isoformat()
        })
        
        return True
        
    except Exception as e:
        self.logger.error(f"Failed to process file: {str(e)}")
        self.status_tracker.update_file_status(
            file_id, 
            'error', 
            message=str(e)
        )
        return False
```### 3.4 ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะบััะธัะพะฒะฐะฝะธั

```mermaid
sequenceDiagram
    participant PipelineCoord as Pipeline
    participant CacheMan as CacheManager
    participant APIClient as API Client
    participant ExternalAPI as External API
    
    PipelineCoord->>CacheMan: check_cache(key)
    
    alt Cache Hit
        CacheMan-->>PipelineCoord: cached_data
        PipelineCoord->>PipelineCoord: Continue with cached data
    else Cache Miss
        CacheMan-->>PipelineCoord: None
        PipelineCoord->>APIClient: api_request(params)
        APIClient->>ExternalAPI: HTTP Request
        ExternalAPI-->>APIClient: Response
        APIClient->>CacheMan: store_cache(key, response)
        CacheMan-->>APIClient: success
        APIClient-->>PipelineCoord: response_data
    end
```### 2.10 Cache Manager

**ะะฐะทะฝะฐัะตะฝะธะต**: ะฃะฟัะฐะฒะปะตะฝะธะต ะปะพะบะฐะปัะฝัะผ ะบััะธัะพะฒะฐะฝะธะตะผ ะดะฐะฝะฝัั, ัะตะทัะปััะฐัะพะฒ API-ะฒัะทะพะฒะพะฒ ะธ ะฟัะพะผะตะถััะพัะฝัั ัะตะทัะปััะฐัะพะฒ ะพะฑัะฐะฑะพัะบะธ.

**ะะปััะตะฒัะต ะบะปะฐััั**:
- `CacheManager`: ะัะฝะพะฒะฝะพะน ะบะปะฐัั ัะฟัะฐะฒะปะตะฝะธั ะบััะตะผ
- `CacheStore`: ะฅัะฐะฝะธะปะธัะต ะบััะธัะพะฒะฐะฝะฝัั ะดะฐะฝะฝัั
- `CachePolicy`: ะะพะปะธัะธะบะธ ะบััะธัะพะฒะฐะฝะธั ะธ ัะฟัะฐะฒะปะตะฝะธั ัััะฐัะตะฒะฐะฝะธะตะผ ะดะฐะฝะฝัั
- `CacheKey`: ะะตะฝะตัะฐัะพั ัะฝะธะบะฐะปัะฝัั ะบะปััะตะน ะดะปั ะบััะธััะตะผัั ะพะฑัะตะบัะพะฒ

**ะะฝัะตััะตะนั**:
```python
class CacheManager:
    def __init__(self, cache_dir: str, retention_days: int = 30):
        """ะะฝะธัะธะฐะปะธะทะฐัะธั ะผะตะฝะตะดะถะตัะฐ ะบััะธัะพะฒะฐะฝะธั"""
        self.cache_dir = cache_dir
        self.retention_days = retention_days
        self.logger = logging.getLogger('cache_manager')
        
    def get(self, cache_type: str, key: str) -> Optional[Any]:
        """ะะพะปััะตะฝะธะต ะพะฑัะตะบัะฐ ะธะท ะบััะฐ ะฟะพ ัะธะฟั ะธ ะบะปััั"""
        cache_path = self._get_cache_path(cache_type, key)
        
        if not os.path.exists(cache_path):
            return None
            
        try:
            with open(cache_path, 'rb') as f:
                return pickle.load(f)
        except Exception as e:
            self.logger.warning(f"Failed to load from cache: {str(e)}")
            return None
            
    def store(self, cache_type: str, key: str, data: Any) -> bool:
        """ะกะพััะฐะฝะตะฝะธะต ะพะฑัะตะบัะฐ ะฒ ะบัั"""
        cache_path = self._get_cache_path(cache_type, key)
        os.makedirs(os.path.dirname(cache_path), exist_ok=True)
        
        try:
            with open(cache_path, 'wb') as f:
                pickle.dump(data, f)
            return True
        except Exception as e:
            self.logger.error(f"Failed to store in cache: {str(e)}")
            return False
            
    def has_valid_cache(self, cache_type: str, key: str, max_age_days: int = None) -> bool:
        """ะัะพะฒะตัะบะฐ ะฝะฐะปะธัะธั ะฒะฐะปะธะดะฝะพะณะพ ะบััะฐ"""
        cache_path = self._get_cache_path(cache_type, key)
        
        if not os.path.exists(cache_path):
            return False
            
        if max_age_days is not None:
            file_time = os.path.getmtime(cache_path)
            age_days = (time.time() - file_time) / (24 * 3600)
            if age_days > max_age_days:
                return False
                
        return True
        
    def invalidate(self, cache_type: str, key: str = None) -> int:
        """ะะฝะฒะฐะปะธะดะฐัะธั ะบััะฐ (ะพะฟัะธะพะฝะฐะปัะฝะพ ะฟะพ ัะธะฟั ะธะปะธ ะบะปััั)"""
        if key is not None:
            cache_path = self._get_cache_path(cache_type, key)
            if os.path.exists(cache_path):
                os.remove(cache_path)
                return 1
            return 0
            
        # ะะฝะฒะฐะปะธะดะฐัะธั ะฒัะตะณะพ ัะธะฟะฐ ะบััะฐ
        type_dir = os.path.join(self.cache_dir, cache_type)
        if not os.path.exists(type_dir):
            return 0
            
        count = 0
        for file in os.listdir(type_dir):
            file_path = os.path.join(type_dir, file)
            if os.path.isfile(file_path):
                os.remove(file_path)
                count += 1
                
        return count
        
    def cleanup(self) -> int:
        """ะัะธััะบะฐ ัััะฐัะตะฒัะธั ะดะฐะฝะฝัั ะบััะฐ"""
        if not os.path.exists(self.cache_dir):
            return 0
            
        count = 0
        now = time.time()
        max_age = self.retention_days * 24 * 3600
        
        for root, _, files in os.walk(self.cache_dir):
            for file in files:
                file_path = os.path.join(root, file)
                file_time = os.path.getmtime(file_path)
                
                if now - file_time > max_age:
                    os.remove(file_path)
                    count += 1
                    
        return count
        
    def _get_cache_path(self, cache_type: str, key: str) -> str:
        """ะะพะปััะตะฝะธะต ะฟััะธ ะบ ัะฐะนะปั ะบััะฐ"""
        # ะกะพะทะดะฐะตะผ ะฑะตะทะพะฟะฐัะฝะพะต ะธะผั ัะฐะนะปะฐ ะธะท ะบะปััะฐ
        safe_key = hashlib.md5(key.encode('utf-8')).hexdigest()
        return os.path.join(self.cache_dir, cache_type, safe_key)
```

**ะขะธะฟั ะบััะธััะตะผัั ะดะฐะฝะฝัั**:
- `transcription`: ะะตะทัะปััะฐัั ััะฐะฝัะบัะธะฑะฐัะธะธ ะธะท Rev.ai API
- `analysis`: ะะตะทัะปััะฐัั ะฐะฝะฐะปะธะทะฐ ัะตะบััะฐ ัะตัะตะท Claude API
- `metadata`: ะะตัะฐะดะฐะฝะฝัะต ัะฐะนะปะพะฒ
- `prompts`: ะกะบะพะผะฟะธะปะธัะพะฒะฐะฝะฝัะต ัะฐะฑะปะพะฝั ะฟัะพะผะฟัะพะฒ

**ะัะธะผะตั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะบััะธัะพะฒะฐะฝะธั ะดะปั API-ะทะฐะฟัะพัะพะฒ**:
```python
class ClaudeClient:
    def __init__(self, api_key: str, cache_manager: CacheManager):
        import anthropic
        self.client = anthropic.Anthropic(api_key=api_key)
        self.model = "claude-3-opus-20240229"
        self.logger = logging.getLogger('claude_client')
        self.cache_manager = cache_manager
    
    def analyze_text(self, text: str, prompt_template: str, **params) -> str:
        """ะะฝะฐะปะธะท ัะตะบััะฐ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ัะฐะฑะปะพะฝะฐ ะฟัะพะผะฟัะฐ ะธ ะบััะธัะพะฒะฐะฝะธั"""
        # ะคะพัะผะธััะตะผ ะบะปัั ะบััะฐ ะฝะฐ ะพัะฝะพะฒะต ัะตะบััะฐ, ัะฐะฑะปะพะฝะฐ ะธ ะฟะฐัะฐะผะตััะพะฒ
        cache_key = f"{hashlib.md5(text.encode('utf-8')).hexdigest()}_{os.path.basename(prompt_template)}_{json.dumps(params, sort_keys=True)}"
        
        # ะัะพะฒะตััะตะผ ะฝะฐะปะธัะธะต ะบััะฐ
        cached_result = self.cache_manager.get('analysis', cache_key)
        if cached_result:
            self.logger.info(f"Using cached analysis result for {os.path.basename(prompt_template)}")
            return cached_result
        
        try:
            # ะะฐะณััะทะบะฐ ัะฐะฑะปะพะฝะฐ ะฟัะพะผะฟัะฐ
            with open(prompt_template, 'r') as f:
                prompt = f.read()
            
            # ะะพะดััะฐะฝะพะฒะบะฐ ะฟะฐัะฐะผะตััะพะฒ ะฒ ัะฐะฑะปะพะฝ
            full_prompt = prompt.format(transcript=text, **params)
            
            # ะัะทะพะฒ API
            response = self.client.messages.create(
                model=self.model,
                max_tokens=params.get('max_tokens', 1000),
                temperature=params.get('temperature', 0.1),
                messages=[
                    {"role": "user", "content": full_prompt}
                ]
            )
            result = response.content[0].text
            
            # ะกะพััะฐะฝัะตะผ ัะตะทัะปััะฐั ะฒ ะบัั
            self.cache_manager.store('analysis', cache_key, result)
            
            return result
        except Exception as e:
            self.logger.error(f"Claude API error: {str(e)}")
            raise ApiAnalysisError(f"Claude API error: {str(e)}")
```>)

## 6. ะะตะทะพะฟะฐัะฝะพััั

### 6.1 ะฅัะฐะฝะตะฝะธะต ัะตะบัะตัะพะฒ

API-ะบะปััะธ ััะฐะฝัััั ะฒ macOS Keychain, ััะพ ะพะฑะตัะฟะตัะธะฒะฐะตั ะฑะตะทะพะฟะฐัะฝะพะต ััะฐะฝะตะฝะธะต:

```python
import keyring

class SecretManager:
    SERVICE_NAME = "meet2obsidian"
    
    def store_api_key(self, key_name: str, api_key: str) -> bool:
        """ะกะพััะฐะฝะตะฝะธะต API ะบะปััะฐ ะฒ Keychain"""
        try:
            keyring.set_password(self.SERVICE_NAME, key_name, api_key)
            return True
        except Exception as e:
            logging.error(f"Failed to store API key: {str(e)}")
            return False
    
    def get_api_key(self, key_name: str) -> Optional[str]:
        """ะะพะปััะตะฝะธะต API ะบะปััะฐ ะธะท Keychain"""
        try:
            return keyring.get_password(self.SERVICE_NAME, key_name)
        except Exception as e:
            logging.error(f"Failed to retrieve API key: {str(e)}")
            return None
```

### 6.2 ะฃะฟัะฐะฒะปะตะฝะธะต ะดะพัััะฟะพะผ ะบ ัะฐะนะปะฐะผ

```python
def ensure_secure_permissions(self, file_path: str) -> bool:
    """ะะฑะตัะฟะตัะตะฝะธะต ะฑะตะทะพะฟะฐัะฝัั ะฟัะฐะฒ ะดะพัััะฟะฐ ะบ ัะฐะนะปั"""
    try:
        # ะฃััะฐะฝะพะฒะธัั ะฟัะฐะฒะฐ ัะพะปัะบะพ ะดะปั ัะตะบััะตะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั
        os.chmod(file_path, 0o600)  # rw-------
        return True
    except OSError as e:
        self.logger.error(f"Failed to set secure permissions: {str(e)}")
        return False
```

## 7. ะะพะดัะปัะฝัะต ัะตััั

### 7.1 ะกััะฐัะตะณะธั ัะตััะธัะพะฒะฐะฝะธั

1. **ะะพะดัะปัะฝัะต ัะตััั**:
   - ะะปั ะบะฐะถะดะพะณะพ ะบะปััะตะฒะพะณะพ ะบะปะฐััะฐ ะธ ะบะพะผะฟะพะฝะตะฝัะฐ
   - ะก ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะผะพะบะพะฒ ะดะปั ะฒะฝะตัะฝะธั ะทะฐะฒะธัะธะผะพััะตะน
   - ะขะตััะธัะพะฒะฐะฝะธะต ะณัะฐะฝะธัะฝัั ััะปะพะฒะธะน ะธ ะพะฑัะฐะฑะพัะบะธ ะพัะธะฑะพะบ

2. **ะะฝัะตะณัะฐัะธะพะฝะฝัะต ัะตััั**:
   - ะขะตััะธัะพะฒะฐะฝะธะต ะฒะทะฐะธะผะพะดะตะนััะฒะธั ะบะพะผะฟะพะฝะตะฝัะพะฒ
   - ะขะตััะธัะพะฒะฐะฝะธะต ั ัะธะบัะธะฒะฝัะผะธ API-ะพัะฒะตัะฐะผะธ
   - ะัะพะฒะตัะบะฐ ะบะพะฝะฒะตะนะตัะฐ ะพะฑัะฐะฑะพัะบะธ

3. **ะกะธััะตะผะฝัะต ัะตััั**:
   - ะขะตััะธัะพะฒะฐะฝะธะต ะฟะพะปะฝะพะณะพ ัะฐะฑะพัะตะณะพ ัะธะบะปะฐ
   - ะัะพะฒะตัะบะฐ ะฒะพัััะฐะฝะพะฒะปะตะฝะธั ะฟะพัะปะต ัะฑะพะตะฒ
   - ะขะตััะธัะพะฒะฐะฝะธะต ั ัะตะฐะปัะฝัะผะธ ัะฐะนะปะฐะผะธ

### 7.2 ะัะธะผะตัั ัะตััะพะฒ

```python
# ะัะธะผะตั ะผะพะดัะปัะฝะพะณะพ ัะตััะฐ ะดะปั AudioExtractor
def test_audio_extraction_success():
    # Arrange
    extractor = AudioExtractor()
    mock_video = "tests/data/sample_video.mp4"
    output_path = "tests/output/output.m4a"
    
    # Act
    success, _ = extractor.extract_audio(mock_video, output_path)
    
    # Assert
    assert success is True
    assert os.path.exists(output_path)
    assert get_file_size(output_path) > 0

# ะัะธะผะตั ัะตััะฐ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะผะพะบะพะฒ
@patch('meet2obsidian.api.RevAiClient')
def test_transcription_job_submission(mock_client):
    # Arrange
    mock_instance = mock_client.return_value
    mock_instance.submit_transcription_job.return_value = "test_job_id"
    
    pipeline = ProcessingPipeline()
    
    # Act
    job_id = pipeline._submit_transcription("test.m4a")
    
    # Assert
    assert job_id == "test_job_id"
    mock_instance.submit_transcription_job.assert_called_once_with("test.m4a")
```

## 8. ะะฐะทะฒะตัััะฒะฐะฝะธะต ะธ ัััะฐะฝะพะฒะบะฐ

### 8.1 ะฃััะฐะฝะพะฒะบะฐ

ะฃััะฐะฝะพะฒะบะฐ ะฟัะพะธะทะฒะพะดะธััั ั ะฟะพะผะพััั ัะบัะธะฟัะฐ ัััะฐะฝะพะฒะบะธ, ะบะพัะพััะน ะฒัะฟะพะปะฝัะตั ัะปะตะดัััะธะต ะดะตะนััะฒะธั:

1. ะัะพะฒะตััะตั ะทะฐะฒะธัะธะผะพััะธ (Python, ffmpeg)
2. ะกะพะทะดะฐะตั ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต
3. ะฃััะฐะฝะฐะฒะปะธะฒะฐะตั ะฟะฐะบะตั ะธ ะทะฐะฒะธัะธะผะพััะธ
4. ะะฐัััะฐะธะฒะฐะตั ะบะพะฝัะธะณััะฐัะธั
5. ะกะพะทะดะฐะตั ะฝะตะพะฑัะพะดะธะผัะต ะดะธัะตะบัะพัะธะธ, ะฒะบะปััะฐั ะดะธัะตะบัะพัะธั ะบััะฐ
6. ะะฟัะธะพะฝะฐะปัะฝะพ ะฝะฐัััะฐะธะฒะฐะตั LaunchAgent ะดะปั ะฐะฒัะพะทะฐะฟััะบะฐ

### 8.2 ะกัััะบัััะฐ ะฟะฐะบะตัะฐ

```
meet2obsidian/
โโโ pyproject.toml        # ะะตัะฐะดะฐะฝะฝัะต ะฟัะพะตะบัะฐ
โโโ setup.py              # ะฃััะฐะฝะพะฒะพัะฝัะน ัะบัะธะฟั
โโโ requirements.txt      # ะะฐะฒะธัะธะผะพััะธ
โโโ meet2obsidian/        # ะััะพะดะฝัะน ะบะพะด
โ   โโโ __init__.py
โ   โโโ __main__.py       # ะขะพัะบะฐ ะฒัะพะดะฐ
โ   โโโ cli.py            # CLI ะธะฝัะตััะตะนั
โ   โโโ core.py           # Core ััะฝะบัะธะพะฝะฐะปัะฝะพััั
โ   โโโ config.py         # ะฃะฟัะฐะฒะปะตะฝะธะต ะบะพะฝัะธะณััะฐัะธะตะน
โ   โโโ monitor.py        # ะะพะฝะธัะพัะธะฝะณ ัะฐะนะปะพะฒ
โ   โโโ pipeline.py       # ะะพะฝะฒะตะนะตั ะพะฑัะฐะฑะพัะบะธ
โ   โโโ audio.py          # ะะฑัะฐะฑะพัะบะฐ ะฐัะดะธะพ
โ   โโโ cache.py          # ะกะธััะตะผะฐ ะบััะธัะพะฒะฐะฝะธั
โ   โโโ api/              # API ะบะปะธะตะฝัั
โ   โ   โโโ __init__.py
โ   โ   โโโ revai.py      # Rev.ai API
โ   โ   โโโ claude.py     # Claude API
โ   โโโ note/             # ะะตะฝะตัะฐัะธั ะทะฐะผะตัะพะบ
โ   โ   โโโ __init__.py
โ   โ   โโโ generator.py  # ะะตะฝะตัะฐัะพั ะทะฐะผะตัะพะบ
โ   โ   โโโ obsidian.py   # ะะฝัะตะณัะฐัะธั ั Obsidian
โ   โโโ utils/            # ะฃัะธะปะธัั
โ   โ   โโโ __init__.py
โ   โ   โโโ logging.py    # ะะพะณะธัะพะฒะฐะฝะธะต
โ   โ   โโโ security.py   # ะะตะทะพะฟะฐัะฝะพััั
โ   โ   โโโ status.py     # ะััะปะตะถะธะฒะฐะฝะธะต ััะฐัััะฐ
โ   โโโ templates/        # ะจะฐะฑะปะพะฝั
โ       โโโ prompts/      # ะจะฐะฑะปะพะฝั ะฟัะพะผะฟัะพะฒ
โ       โโโ notes/        # ะจะฐะฑะปะพะฝั ะทะฐะผะตัะพะบ
โโโ scripts/              # ะัะฟะพะผะพะณะฐัะตะปัะฝัะต ัะบัะธะฟัั
โ   โโโ install.sh        # ะฃััะฐะฝะพะฒะพัะฝัะน ัะบัะธะฟั
โ   โโโ com.user.meet2obsidian.plist  # LaunchAgent ัะฐะฑะปะพะฝ
โโโ tests/                # ะขะตััั
โ   โโโ unit/             # ะะพะดัะปัะฝัะต ัะตััั
โ   โโโ integration/      # ะะฝัะตะณัะฐัะธะพะฝะฝัะต ัะตััั
โ   โโโ data/             # ะขะตััะพะฒัะต ะดะฐะฝะฝัะต
โโโ docs/                 # ะะพะบัะผะตะฝัะฐัะธั
    โโโ README.md         # ะัะฝะพะฒะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั
    โโโ USAGE.md          # ะัะบะพะฒะพะดััะฒะพ ะฟะพะปัะทะพะฒะฐัะตะปั
    โโโ DEVELOPMENT.md    # ะัะบะพะฒะพะดััะฒะพ ัะฐะทัะฐะฑะพััะธะบะฐ
```

### 8.3 ะคะฐะนะปะพะฒะฐั ััััะบัััะฐ ะฟะพะปัะทะพะฒะฐัะตะปััะบะธั ะดะฐะฝะฝัั

```
~
โโโ .config/
โ   โโโ meet2obsidian/
โ       โโโ config.yaml         # ะะพะฝัะธะณััะฐัะธะพะฝะฝัะน ัะฐะนะป
โ       โโโ prompts/            # ะะพะปัะทะพะฒะฐัะตะปััะบะธะต ะฟัะพะผะฟัั
โโโ .local/
โ   โโโ share/
โ       โโโ meet2obsidian/
โ           โโโ status/         # ะคะฐะนะปั ััะฐัััะฐ
โ           โโโ cache/          # ะัั ะดะฐะฝะฝัั
โ               โโโ transcriptions/  # ะััะธัะพะฒะฐะฝะฝัะต ััะฐะฝัะบัะธะฟัะธะธ
โ               โโโ analysis/        # ะััะธัะพะฒะฐะฝะฝัะต ัะตะทัะปััะฐัั ะฐะฝะฐะปะธะทะฐ
โ               โโโ processed_files/ # ะะพะปะฝัะต ัะตะทัะปััะฐัั ะพะฑัะฐะฑะพัะบะธ
โโโ Library/
    โโโ Logs/
    โ   โโโ meet2obsidian/      # ะะพะณะธ ะฟัะธะปะพะถะตะฝะธั
    โโโ LaunchAgents/
        โโโ com.user.meet2obsidian.plist # ะคะฐะนะป ะฐะฒัะพะทะฐะฟััะบะฐ
```

## 9. ะะณัะฐะฝะธัะตะฝะธั ะธ ะดะพะฟััะตะฝะธั

### 9.1 ะะณัะฐะฝะธัะตะฝะธั

1. **ะคะพัะผะฐั ัะฐะนะปะพะฒ**: ะะพะดะดะตัะถะธะฒะฐัััั ัะพะปัะบะพ MP4 ะฒะธะดะตะพัะฐะนะปั
2. **ะะปะธัะตะปัะฝะพััั**: ะะฐะบัะธะผะฐะปัะฝะฐั ะดะปะธัะตะปัะฝะพััั ะฒะธะดะตะพ - 4 ัะฐัะฐ
3. **ะะปะฐััะพัะผะฐ**: ะขะพะปัะบะพ macOS, ะผะธะฝะธะผะฐะปัะฝะฐั ะฒะตััะธั 11 (Big Sur)
4. **ะะฐะฒะธัะธะผะพััะธ**: ะขัะตะฑัะตััั ัััะฐะฝะพะฒะปะตะฝะฝัะน ffmpeg
5. **API-ะทะฐะฒะธัะธะผะพััะธ**: ะขัะตะฑััััั ะดะตะนััะฒัััะธะต API-ะบะปััะธ ะดะปั Rev.ai ะธ Claude

### 9.2 ะะพะฟััะตะฝะธั

1. **ะกัััะบัััะฐ ะฒะธะดะตะพัะฐะนะปะพะฒ**: ะัะตะดะฟะพะปะฐะณะฐะตััั, ััะพ ะธะผะตะฝะฐ ัะฐะนะปะพะฒ ัะพะดะตัะถะฐั ะธะฝัะพัะผะฐัะธั ะพ ะดะฐัะต ะธ ะฒัะตะผะตะฝะธ
2. **Obsidian**: ะัะตะดะฟะพะปะฐะณะฐะตััั, ััะพ Obsidian ัััะฐะฝะพะฒะปะตะฝ ะธ ะฝะฐัััะพะตะฝ
3. **ะัะฐะฒะฐ ะดะพัััะฟะฐ**: ะัะตะดะฟะพะปะฐะณะฐะตััั, ััะพ ะฟะพะปัะทะพะฒะฐัะตะปั ะธะผะตะตั ะฟัะฐะฒะฐ ะฝะฐ ัะพะทะดะฐะฝะธะต ะธ ะธะทะผะตะฝะตะฝะธะต ัะฐะนะปะพะฒ
4. **ะกัะฐะฑะธะปัะฝัะน API**: ะัะตะดะฟะพะปะฐะณะฐะตััั ะพัะฝะพัะธัะตะปัะฝะฐั ััะฐะฑะธะปัะฝะพััั ะธะฝัะตััะตะนัะพะฒ API Rev.ai ะธ Claude

## 10. ะะฐะบะปััะตะฝะธะต

ะััะธัะตะบัััะฐ Meet2Obsidian ัะฟัะพะตะบัะธัะพะฒะฐะฝะฐ ะบะฐะบ ะผะพะฝะพะปะธัะฝะพะต Python-ะฟัะธะปะพะถะตะฝะธะต ั ะผะพะดัะปัะฝะพะน ััััะบัััะพะน, ะบะพัะพัะฐั ะพะฑะตัะฟะตัะธะฒะฐะตั:

1. **ะะฐะดะตะถะฝะพััั**: ะัะพะดัะผะฐะฝะฝัะต ะผะตัะฐะฝะธะทะผั ะฒะพัััะฐะฝะพะฒะปะตะฝะธั ะฟะพัะปะต ัะฑะพะตะฒ
2. **ะะฐััะธััะตะผะพััั**: ะะพะทะผะพะถะฝะพััั ะดะพะฑะฐะฒะปะตะฝะธั ะฝะพะฒัั ะธะฝัะตะณัะฐัะธะน ะฒ ะฑัะดััะตะผ
3. **ะัะพััะพัั**: ะะพะฝััะฝัะน ะธะฝัะตััะตะนั ะบะพะผะฐะฝะดะฝะพะน ัััะพะบะธ ะธ ะฟัะพะทัะฐัะฝะฐั ัะฐะฑะพัะฐ ะฒ ัะพะฝะต
4. **ะะตะทะพะฟะฐัะฝะพััั**: ะะฐัะธัะตะฝะฝะพะต ััะฐะฝะตะฝะธะต API-ะบะปััะตะน ะธ ะฑะตะทะพะฟะฐัะฝะพะต ะพะฑัะฐัะตะฝะธะต ั ัะฐะนะปะฐะผะธ>)